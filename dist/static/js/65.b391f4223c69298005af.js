(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{"3s8Z":function(t,e,a){"use strict";var s=a("kaQf"),i={name:"Upload",props:{disabled:{type:Boolean,default:!1},headers:{type:Object,default:()=>({token:Object(s.l)()})},onSuccess:{type:Function},onProgress:{type:Function},onError:{type:Function},onExceed:{type:Function},beforeUpload:{type:Function},className:{type:[String,Object]},showFileList:{type:Boolean,default:!1},type:{type:String,required:!0}},data:()=>({API:"/api"})},r=a("KHd+"),l=Object(r.a)(i,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("el-upload",{class:t.className,attrs:{disabled:t.disabled,headers:t.headers,action:t.API+"/file/upload","on-success":t.onSuccess,"on-exceed":t.onExceed,"on-progress":t.onProgress,"on-error":t.onError,"before-upload":t.beforeUpload,"show-file-list":t.showFileList,data:{type:t.type}}},[t._t("default")],2)}),[],!1,null,"54fa21fa",null);e.a=l.exports},"5gwH":function(t,e,a){t.exports=a.p+"static/images/compress/audit-waiting.b132f5d.png"},"9XqA":function(t,e,a){},HgT1:function(t,e,a){"use strict";a("RVVG")},IVd5:function(t,e,a){"use strict";var s={name:"uploadImg",components:{Upload:a("3s8Z").a},props:{value:{type:String,default:""},imgtype:{type:String,default:""},imgform:{type:String,default:""},refIndex:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:()=>({upload_url:"/uploadFiles/"}),computed:{imageUrl(){return this.value}},methods:{emitInput(t){this.$emit("input",t,this.refIndex)},handleImageSuccess(t){this.emitInput(t.data)},beforeUpload(t){if(!(t.size/1024/1024<1))return this.$message({message:"上传文件大小不能超过 1MB!",type:"warning"}),!1;const e="image/jpeg"===t.type,a="image/png"===t.type;return!(!e&&!a)||(this.$message.warning("上传头像只能是 JPG、JPEG、PNG 格式!"),!1)}}},i=(a("PflC"),a("KHd+")),r=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"upload-container":"headimg"!=t.imgform}},[a("upload",{attrs:{disabled:t.disabled,"on-success":t.handleImageSuccess,"before-upload":t.beforeUpload,className:{"avatar-uploader":"headimg"!=t.imgform,"avatar-uploader-yuan":"headimg"==t.imgform},"show-file-list":!1,type:"headimg"===t.imgform?"userImage":"userAuth"}},[a("span",[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.upload_url+t.imageUrl}}):a("i",{class:{"el-icon-plus":!0,"avatar-uploader-main":"idCardFront"==t.imgtype,"avatar-uploader-back":"idCardBack"==t.imgtype,"avatar-uploader-headimg":"headimg"==t.imgtype}})])])],1)}),[],!1,null,null,null);e.a=r.exports},"Joe+":function(t,e,a){},PTZL:function(t,e,a){"use strict";a.r(e);var s=a("IVd5"),i=a("kaQf"),r=a("RgSw"),l={name:"AuditHistory",data:()=>({tableData:[],total:0,pageNo:1,pageSize:15,currentData:{},detailStatus:!1}),mounted(){this.queryList()},methods:{queryList(){this.$api.personal.auditHistory({pageNo:this.pageNo,pageSize:this.pageSize}).then(({data:t})=>{this.tableData=t.data.list,this.total=t.data.total})},detail(t){this.currentData=t,this.detailStatus=!0},handleCurrentChange(t){this.pageNo=t,this.queryList()},handleSizeChange(t){this.pageSize=t,this.queryList()},handleClose(){this.currentData={},this.detailStatus=!1}}},o=(a("Tr20"),a("KHd+")),n=Object(o.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit-history"},[a("div",{staticClass:"title"},[t._v("审核记录")]),t._v(" "),a("el-table",{ref:"table",staticClass:"has-expand-table",attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"审核时间",prop:"auditTime",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"审核人",align:"center",prop:"updateUser","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"审核状态",align:"center",prop:"auditStateDesc","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"审核意见",align:"center",prop:"auditAdvice","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",prop:"id",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.detail(e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",total:t.total,"page-size":15,"page-sizes":[15],layout:"prev, pager, next, jumper, total, sizes"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),t._v(" "),a("el-dialog",{staticClass:"audit-history-detail",attrs:{title:"查看",visible:t.detailStatus,width:"570px","before-close":t.handleClose},on:{"update:visible":function(e){t.detailStatus=e}}},[a("div",{staticClass:"title"},[t._v("审核记录")]),t._v(" "),a("el-form",{attrs:{model:t.currentData,"label-width":"75px","label-suffix":"："}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"auditTime",label:"审核时间"}},[a("div",[t._v(t._s(t.currentData.auditTime))])])],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"updateUser",label:"审核人"}},[a("div",[t._v(t._s(t.currentData.updateUser))])])],1)],1),t._v(" "),a("el-form-item",{attrs:{prop:"auditStateDesc",label:"审核状态"}},[a("div",[t._v(t._s(t.currentData.auditStateDesc))])]),t._v(" "),a("el-form-item",{attrs:{prop:"auditAdvice",label:"审核意见"}},[a("div",{staticClass:"advice"},[t._v(t._s(t.currentData.auditAdvice))])])],1)],1)],1)}),[],!1,null,"7847521f",null).exports,u={name:"personalInfo",components:{Upload:s.a,AuthDialog:r.a,AuditHistory:n},data:()=>({personalForm:{headImage:"",realName:"",mobile:"",introduction:"",skill:"",specializedTreatmentList:[],userAuthList:[]},specializedTreatment:"",personalRules:{},authDialogStatus:!1,upload_url:"/uploadFiles/",removeTreatmentIds:[],removeAuthIds:[],currentAuth:null,canSave:!1,canAudit:!1,auditState:""}),mounted(){this.getUsercenterInfo()},methods:{editAuth(t){this.currentAuth=t,this.authDialogStatus=!0},deleteAuth(t,e){this.personalForm.userAuthList.splice(e,1),t.id&&this.removeAuthIds.push(t.id)},handleAuthClose(){this.currentAuth=null,this.authDialogStatus=!1},handleAuthSubmit(t){if(this.currentAuth){const e=this.personalForm.userAuthList.indexOf(this.currentAuth);this.personalForm.userAuthList[e]=t}else this.personalForm.userAuthList.push(t);this.currentAuth=null,this.authDialogStatus=!1},addSpecializedTreatment(){this.specializedTreatment=this.specializedTreatment.trim(),this.specializedTreatment&&(this.personalForm.specializedTreatmentList.push({content:this.specializedTreatment}),this.specializedTreatment="")},deleteSpecializedTreatment(t){this.personalForm.specializedTreatmentList.splice(this.personalForm.specializedTreatmentList.indexOf(t),1),t.id&&this.removeTreatmentIds.push(t.id)},getUsercenterInfo(){this.removeTreatmentIds=[],this.removeAuthIds=[],this.$api.personal.userCenter().then(t=>{this.personalForm.headImage=t.data.data.headImage,this.personalForm.realName=t.data.data.realName,this.personalForm.mobile=t.data.data.mobile,this.personalForm.introduction=t.data.data.introduction,this.personalForm.skill=t.data.data.skill,this.personalForm.specializedTreatmentList=t.data.data.specializedTreatmentList,this.personalForm.userAuthList=t.data.data.userAuthList,this.auditState=t.data.data.auditState})},save(t){this.$refs.personalForm.validate(e=>{e&&this.$api.personal[t]({...this.personalForm,removeTreatmentIds:this.removeTreatmentIds,removeAuthIds:this.removeAuthIds}).then(()=>{this.$message.success("操作成功"),this.getUsercenterInfo(),this.updateUserInfo()})})},updateUserInfo(){this.$store.commit("user/SET_AVATAR",this.personalForm.headImage);const t=Object(i.m)("HK_USER_INFO"),e=JSON.parse(t);e.headImage=this.personalForm.headImage,Object(i.n)("HK_USER_INFO",JSON.stringify(e))}}},d=(a("uOsb"),{name:"PersonalCenter",components:{PersonalInfo:Object(o.a)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"personalContent"},[t.$store.state.user.superAdmin?t._e():[0===t.auditState?s("img",{staticClass:"audit-status-image",attrs:{src:a("5gwH")}}):t._e(),t._v(" "),3===t.auditState?s("img",{staticClass:"audit-status-image",attrs:{src:a("wEUE")}}):t._e(),t._v(" "),1===t.auditState?s("img",{staticClass:"audit-status-image",attrs:{src:a("eFYi")}}):t._e()],t._v(" "),s("div",{staticClass:"person-title"},[t._v("个人信息")]),t._v(" "),s("el-form",{ref:"personalForm",staticClass:"inputCommon",attrs:{model:t.personalForm,rules:t.personalRules,"label-width":"70px"}},[s("el-form-item",{staticClass:"form-item-avatar",attrs:{label:"头像"}},[s("Upload",{attrs:{imgtype:"headimg",imgform:"headimg"},model:{value:t.personalForm.headImage,callback:function(e){t.$set(t.personalForm,"headImage",e)},expression:"personalForm.headImage"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"姓名"}},[s("div",[t._v(t._s(t.personalForm.realName))])]),t._v(" "),s("el-form-item",{attrs:{label:"联系电话"}},[s("div",[t._v(t._s(t.personalForm.mobile))])]),t._v(" "),s("el-form-item",{attrs:{label:"简介"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"1000",disabled:3===t.auditState,placeholder:3===t.auditState?"":"请简单的介绍你自己吧","show-word-limit":3!==t.auditState},model:{value:t.personalForm.introduction,callback:function(e){t.$set(t.personalForm,"introduction",e)},expression:"personalForm.introduction"}})],1)],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"擅长"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"1000",disabled:3===t.auditState,placeholder:3===t.auditState?"":"您擅长什么都可以写出来","show-word-limit":3!==t.auditState},model:{value:t.personalForm.skill,callback:function(e){t.$set(t.personalForm,"skill",e)},expression:"personalForm.skill"}})],1)],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"专治"}},[3!==t.auditState?s("el-row",[s("el-col",{attrs:{span:12}},[s("el-input",{attrs:{maxlength:"30",placeholder:"请输入后添加"},model:{value:t.specializedTreatment,callback:function(e){t.specializedTreatment=e},expression:"specializedTreatment"}})],1),t._v(" "),s("el-button",{staticClass:"add-button",attrs:{size:"small"},on:{click:t.addSpecializedTreatment}},[t._v("添加")])],1):t._e(),t._v(" "),t.personalForm.specializedTreatmentList.length>0?s("div",{staticClass:"specialized-treatments"},t._l(t.personalForm.specializedTreatmentList,(function(e,a){return s("el-tag",{key:a,attrs:{closable:3!==t.auditState},on:{close:function(a){return t.deleteSpecializedTreatment(e)}}},[t._v("\n          "+t._s(e.content)+"\n        ")])})),1):t._e()],1),t._v(" "),t.$store.state.user.superAdmin?t._e():[s("div",{staticClass:"person-title"},[t._v("认证信息")]),t._v(" "),s("div",{staticClass:"auth-list"},[t._l(t.personalForm.userAuthList,(function(e,a){return s("div",{key:a,staticClass:"auth-item"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:t.upload_url+e.certificateImageUrl}}),t._v(" "),3!==t.auditState?s("div",[s("span",{staticClass:"auth-btn"},[s("i",{staticClass:"el-icon-edit-outline",on:{click:function(a){return t.editAuth(e)}}})]),t._v(" "),s("span",{staticClass:"auth-btn"},[s("i",{staticClass:"el-icon-delete",on:{click:function(s){return t.deleteAuth(e,a)}}})])]):t._e()]),t._v(" "),s("div",{staticClass:"bottom"},[s("div",{staticClass:"name"},[t._v(t._s(e.userAuthName))]),t._v(" "),s("div",{staticClass:"type"},[t._v(t._s(e.userAuthTypeDesc))])])])})),t._v(" "),3!==t.auditState?s("div",{staticClass:"add-auth",on:{click:function(e){t.authDialogStatus=!0}}},[s("i",{staticClass:"el-icon-circle-plus"}),t._v(" "),s("div",[t._v("新增认证信息")])]):t._e()],2)],t._v(" "),s("div",{staticClass:"buttons"},[s("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")]),t._v(" "),3===t.auditState||t.$store.state.user.superAdmin?t._e():s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.save("submitAudit")}}},[t._v("提交审核")]),t._v(" "),3!==t.auditState?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.save("saveUserInfo")}}},[t._v("保存")]):t._e()],1)],2),t._v(" "),t.authDialogStatus?s("auth-dialog",{attrs:{authData:t.currentAuth},on:{close:t.handleAuthClose,submit:t.handleAuthSubmit}}):t._e(),t._v(" "),t.$store.state.user.superAdmin?t._e():s("audit-history")],2)}),[],!1,null,"2b27fce8",null).exports,ModifyPassword:a("g9ZM").a}}),m=(a("sDGQ"),Object(o.a)(d,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"personal-center"},[e("el-tabs",[e("el-tab-pane",{attrs:{label:"个人信息"}},[e("personal-info")],1),this._v(" "),e("el-tab-pane",{attrs:{label:"修改密码"}},[e("modify-password")],1)],1)],1)}),[],!1,null,"67251c2b",null));e.default=m.exports},PflC:function(t,e,a){"use strict";a("X3jJ")},RVVG:function(t,e,a){},RgSw:function(t,e,a){"use strict";var s={name:"AuthDialog",components:{Upload:a("3s8Z").a},props:{authData:{type:Object}},data:()=>({form:{id:"",userAuthType:"",userAuthName:"",certificateImageUrl:""},rules:{userAuthType:[{required:!0,message:"请选择职称类别"}],userAuthName:[{required:!0,message:"请输入职称名称"}],certificateImageUrl:[{required:!0,message:"请上传职称证件"}]},typeList:[]}),mounted(){this.getTypeList(),this.authData&&(this.form.id=this.authData.id,this.form.userAuthType=this.authData.userAuthType,this.form.userAuthName=this.authData.userAuthName,this.form.certificateImageUrl=this.authData.certificateImageUrl)},methods:{getTypeList(){this.$api.personal.getTypeList().then(({data:t})=>{this.typeList=t.data||[]})},handleClose(){this.$emit("close")},beforeUpload(t){if(!(t.size/1024/1024<=5))return this.$message.warning("上传文件大小不能超过 5MB!"),!1;const e="image/jpeg"===t.type,a="image/png"===t.type;return!(!e&&!a)||(this.$message.warning("上传附件只能是 JPG、JPEG、PNG 格式!"),!1)},handleImageSuccess(t){const{code:e,data:a,message:s}=t;200===e?this.form.certificateImageUrl=a:this.$message.error(s||"网络异常！")},submit(){this.$refs.form.validate(t=>{if(t){const{id:t,userAuthType:e,userAuthName:a,certificateImageUrl:s}=this.form;let i="";for(let t=0;t<this.typeList.length;t++)if(this.typeList[t].paramValue===e){i=this.typeList[t].name;break}this.$emit("submit",{id:t,userAuthName:a,userAuthType:e,certificateImageUrl:s,userAuthTypeDesc:i})}})}}},i=(a("HgT1"),a("KHd+")),r=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"auth-dialog",attrs:{title:t.authData?"编辑认证信息":"新增认证信息",visible:!0,width:"570px","before-close":t.handleClose}},[a("div",{staticClass:"title"},[t._v("认证信息")]),t._v(" "),a("el-form",{ref:"form",attrs:{rules:t.rules,model:t.form,"label-width":"90px","label-suffix":"："}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职称类别",prop:"userAuthType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.userAuthType,callback:function(e){t.$set(t.form,"userAuthType",e)},expression:"form.userAuthType"}},t._l(t.typeList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.paramValue}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职称名称",prop:"userAuthName"}},[a("el-input",{attrs:{maxlength:"30",placeholder:"请输入"},model:{value:t.form.userAuthName,callback:function(e){t.$set(t.form,"userAuthName",e)},expression:"form.userAuthName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"职称证件",prop:"certificateImageUrl"}},[a("div",{staticClass:"form-item-upload"},[a("el-input",{attrs:{disabled:"",placeholder:t.form.certificateImageUrl?"已上传":"请上传小于5M的附件"}}),t._v(" "),a("upload",{attrs:{"on-success":t.handleImageSuccess,"before-upload":t.beforeUpload,"show-file-list":!1,type:"userAuth"}},[a("el-button",{attrs:{size:"small"}},[t._v(t._s(t.form.certificateImageUrl?"重新上传":"上传"))])],1)],1)])],1)],1)],1),t._v(" "),a("div",{staticClass:"buttons"},[a("el-button",{attrs:{plain:"",size:"small"},on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("确定")])],1)],1)}),[],!1,null,"552a94df",null);e.a=r.exports},Tr20:function(t,e,a){"use strict";a("cvMv")},X3jJ:function(t,e,a){},Xxbr:function(t,e,a){"use strict";a("9XqA")},cvMv:function(t,e,a){},eFYi:function(t,e,a){t.exports=a.p+"static/images/compress/audit-success.b219f17.png"},g9ZM:function(t,e,a){"use strict";var s={name:"ModifyPassword",data:()=>({modifyForm:{oldPassword:"",newPassword:"",confirmPassword:""},modifyRules:{oldPassword:[{required:!0,message:"愿密码不能为空"}],newPassword:[{required:!0,message:"新密码不能为空"}],confirmPassword:[{required:!0,message:"确认密码不能为空"}]}}),methods:{save(){this.$refs.modifyForm.validate(t=>{t&&this.modifyPassword()})},modifyPassword(){const t={...this.modifyForm};this.$api.loginInterface.modifyPassword(t).then(()=>{this.$message.success("操作成功"),this.$refs.modifyForm.resetFields()})}}},i=(a("Xxbr"),a("KHd+")),r=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modify-password inputCommon"},[a("div",{staticClass:"modify-title"},[t._v("修改密码")]),t._v(" "),a("el-form",{ref:"modifyForm",attrs:{model:t.modifyForm,rules:t.modifyRules,"label-width":"90px","label-suffix":"：","lable-position":"right"}},[a("el-form-item",{attrs:{label:"原密码",prop:"oldPassword"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入原密码"},model:{value:t.modifyForm.oldPassword,callback:function(e){t.$set(t.modifyForm,"oldPassword",e)},expression:"modifyForm.oldPassword"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:t.modifyForm.newPassword,callback:function(e){t.$set(t.modifyForm,"newPassword",e)},expression:"modifyForm.newPassword"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入"},model:{value:t.modifyForm.confirmPassword,callback:function(e){t.$set(t.modifyForm,"confirmPassword",e)},expression:"modifyForm.confirmPassword"}})],1),t._v(" "),a("div",{staticClass:"form-buttons"},[a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")]),t._v(" "),a("el-button",{staticClass:"save-button",attrs:{type:"primary",size:"small"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)}),[],!1,null,"f9ad665c",null);e.a=r.exports},hqLh:function(t,e,a){},sDGQ:function(t,e,a){"use strict";a("hqLh")},uOsb:function(t,e,a){"use strict";a("Joe+")},wEUE:function(t,e,a){t.exports=a.p+"static/images/compress/audit-pending.9437216.png"}}]);