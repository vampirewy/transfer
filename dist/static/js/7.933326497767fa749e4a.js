(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"3u9L":function(e,t,a){},"4toc":function(e,t,a){},HYB1:function(e,t,a){"use strict";var s={name:"interventionTplOpen",props:{visible:Boolean,value:{default:()=>[]},clientIds:{default:()=>[]},propsType:{default:""}},data:()=>({formData:{},params:{keywords:"",pageNo:1,pageSize:5,total:0},tableData:[],multipleSelection:[],map:{},selectRadio:""}),watch:{selectRadio(e){const t=this.tableData.filter(t=>t.id===e);this.$emit("change",t.length>0?t[0]:null)}},methods:{handleRowClick(e){this.$emit("change",e)},handleCurrentChange(e){this.search(e)},handleSizeChange(e){this.params.pageSize=e,this.search()},cancel(){this.$emit("cancel")},submit(){this.$emit("change",[...this.multipleSelection]),this.multipleSelection=[],this.$refs.multipleTable.clearSelection()},fetch(){console.log(this.propsType),"doctor"===this.propsType?this.$api.userFollowInterface.healthDoctorList({pageNo:this.params.pageNo,pageSize:5,keywords:this.params.keywords,clientIds:this.clientIds}).then(({data:e})=>{console.log(e.data),this.params.total=e.data.total,this.tableData=e.data.data,this.tableData.forEach(e=>{this.$set(this.map,e.id,e)}),console.log(this.map)}):this.$api.systemManageInterface.userList({pageNo:this.params.pageNo,pageSize:5,search:this.params.keywords}).then(({data:e})=>{this.params.total=e.data.total,this.tableData=e.data.data,this.tableData.forEach(e=>{this.$set(this.map,e.id,e)}),console.log(this.map)})},search(e=1){this.params.pageNo=e,this.fetch()},reset(){this.params.keywords="",this.params.pageNo=1,this.fetch()},handleSelectionChange(e){this.multipleSelection=e,this.$emit("change",[...this.multipleSelection])}},mounted(){this.fetch()}},l=(a("oQud"),a("KHd+")),i=Object(l.a)(s,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"abnormal-popoper"},[s("div",{staticClass:"divTop",staticStyle:{margin:"-15px 0 15px 0"}},[s("div",{staticClass:"searchCondition"},[s("div",{staticClass:"searchLeft"},[s("div",{staticClass:"searchInputFormItem"},[s("el-input",{attrs:{placeholder:"输入姓名搜索"},model:{value:e.params.keywords,callback:function(t){e.$set(e.params,"keywords",t)},expression:"params.keywords"}}),e._v(" "),s("span",{staticClass:"searchBtnImgSpan",on:{click:function(t){return e.search(1)}}},[s("img",{staticClass:"searchBtnImg",attrs:{src:a("RQrH")}})])],1)]),e._v(" "),s("div",{staticClass:"searchRight"},[s("div",{staticClass:"buttones"},[s("div",{staticClass:"searchFor",on:{click:function(t){return e.search(1)}}},[s("img",{attrs:{src:a("nc5h"),alt:""}})]),e._v(" "),s("div",{staticClass:"resetAll",on:{click:e.reset}},[e._v("重置")])])])])]),e._v(" "),s("el-table",{ref:"multipleTable",staticClass:"openTable",attrs:{data:e.tableData,align:"center"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[s("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row.id},model:{value:e.selectRadio,callback:function(t){e.selectRadio=t},expression:"selectRadio"}},[e._v(" ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"姓名",prop:"realName"}}),e._v(" "),s("el-table-column",{attrs:{label:"启用状态",prop:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s("doctor"===e.propsType||1===t.row.state?"启用":"未启用"))])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev,pager,next,jumper,total,sizes","page-sizes":[5],"pager-count":3,total:e.params.total,"page-size":e.params.pageSize,"current-page":e.params.pageNo},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)}),[],!1,null,"84f38f74",null);t.a=i.exports},Uosx:function(e,t,a){},VZY5:function(e,t,a){"use strict";var s={name:"questionOpen",props:{visible:Boolean,value:{default:()=>[]},clientIds:{default:()=>[]},propsType:{default:""}},data:()=>({formData:{},params:{name:"",pageNo:1,pageSize:5,total:0},tableData:[],multipleSelection:[],map:{},selectRadio:""}),watch:{selectRadio(e){const t=this.tableData.filter(t=>t.id===e);this.$emit("change",t.length>0?t[0]:null)}},methods:{handleRowClick(e){this.$emit("change",e)},handleCurrentChange(e){this.search(e)},handleSizeChange(e){this.params.pageSize=e,this.search()},cancel(){this.$emit("cancel")},submit(){this.$emit("change",[...this.multipleSelection]),this.multipleSelection=[],this.$refs.multipleTable.clearSelection()},fetch(){this.$api.userFollowInterface.getTemplateQuestionListPage({pageNo:this.params.pageNo,pageSize:5,name:this.params.name}).then(({data:e})=>{this.params.total=e.data.total,this.tableData=e.data.data,this.tableData.forEach(e=>{this.$set(this.map,e.id,e)}),console.log(this.map)})},search(e=1){this.params.pageNo=e,this.fetch()},handleSelectionChange(e){this.multipleSelection=e,this.$emit("change",[...this.multipleSelection])}},mounted(){this.fetch()}},l=(a("pdfK"),a("KHd+")),i=Object(l.a)(s,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"abnormal-popoper"},[s("div",{staticClass:"query searchInputFormItem"},[s("el-input",{attrs:{placeholder:"输入问卷名称搜索"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),e._v(" "),s("span",{staticClass:"searchBtnImgSpan",on:{click:function(t){return e.search(1)}}},[s("img",{staticClass:"searchBtnImg",attrs:{src:a("o0KO")}})])],1),e._v(" "),s("el-table",{ref:"multipleTable",attrs:{data:e.tableData,align:"center"},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleRowClick}},[s("el-table-column",{attrs:{width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row.id},model:{value:e.selectRadio,callback:function(t){e.selectRadio=t},expression:"selectRadio"}},[e._v(" ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"问卷名称",prop:"name"}}),e._v(" "),s("el-table-column",{attrs:{label:"题目数量",prop:"subjectCount"}})],1),e._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev,pager,next,jumper,total,sizes","page-sizes":[5],"pager-count":3,total:e.params.total,"page-size":e.params.pageSize,"current-page":e.params.pageNo},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)}),[],!1,null,"00044b6e",null);t.a=i.exports},nfy6:function(e,t,a){"use strict";a("3u9L")},o0KO:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADOklEQVRYR8WWWaiNURTHf//MZShShGS4KYoic5KiWzIXSiEZHhASSYZkSqJbbnlQ5hdRrgwl8XKTIQ9mHkgpoiiZy7S0sr/b9t3znfOdc4v1ds5ee+3fXmt9/73Efzb95/PJDWBmo4FJwBigF9AJ+A68Ae4AV4Cjkj6Vc6mSAGY2BdgKDMoR+D1wANgn6UUO/+wMmFkH4DAwPU+glI9nYY6kc6X2FsyAmfUALgL9UwHuA2eAe8BroA3QDRgXytMx8v8FrJO0pxhEI4Bw82upw28DayV5nQuamTnMKmA90C5y2iBpZ9a+QgB1wLRow0FgqaRvpdLp62bmWTsL9An+3qjDJHmjNrK/AMxscticOB6UtCjPwbGPmXlZbgFdw/9esqGFLpEGuAsMDJuceHjem6chzWwUcBUaGn2lpH1pvwYAMxsBXI8cxhereZ6smNkJYHbwfSRpQDGAXd61weG+pCQTec7KaszhwI1osUrS09g5zkB9UDlf3y5pU8Unh41m5vFfRr2wQNKRLIBXQJewOEvSqaYChK/iEjAhxNomaXMWwFegdVgcI8kbqMlmZkeBeSHQfknLsgA+Am3DYrUkJ2+ymdlJYGYIVCNpdRbAE6BvWFwo6VCTT/8jTK6qI0Os9ZK82RssbsLT0cNzXFKStoo5zMwl+S3QMgSZJOlCFsByoDYsvgO6S/pS8el/bj8XOBZiuJR3lvQhC8C/gOcR7UZJOyoFMLPmwCOgKsSokzQjHS8txU7r1G7+po+Q9LASCDPbBmwMe3+4xEt6XAqge6BOntNnwNi8000S3MzmA7Hg1EpaUegihZ7jxWGsSvx98JiZRxfMrAXgQpPc3GP8BHpKckVsZFkT0W4fQCJvA1wZa4Cbkvx3g5lZe2Aq4PKd1Dx2uQxMkeRi95dlAfj/HmxL9JzGGXkAuHT7FORlGxw1b+LnN28WnVYQouhUbGYTw6fZu8xG9GytCaWsLgaRZyxvBSwBfDIq9kT7d34e2CvJ1c91wN8WH2IzIUoCpGrtUu1vfL8weHoveHP5914v6XM6U6UgygIoswxxk2ZnotKg5e7LyETNP8lAJFDpTNT/U4CoMbcDQ/xT/w2iPSO4RZmu9AAAAABJRU5ErkJggg=="},oQud:function(e,t,a){"use strict";a("Uosx")},pdfK:function(e,t,a){"use strict";a("4toc")},u3Oj:function(e,t,a){"use strict";var s=a("HYB1"),l=a("VZY5"),i={name:"InterventionAddMdl",components:{ManagerList:s.a,QuestionOpen:l.a},data:()=>({show:!0,modalType:1,addType:1,modalTitle:"",planId:"",id:"",selectCheck:[],openCheckVisible:!1,checkClintIds:[],openCheckQuestionVisible:!1,form:{planTime:"",selectTime:null,planTitle:"",planWay:"",planDoctor:"",planDoctorName:"",planContent:"",planWayList:[],templateQuestionId:"",templateQuestionName:""},pickerStartTime:{disabledDate:e=>e.getTime()<Date.now()-864e5},rules:{planTime:[{required:!0,message:"请选择随访时间"}],planWay:[{required:!0,message:"请选择随访形式"}],planDoctorName:[{required:!0,message:"请选择干预人"}],planTitle:[{required:!0,message:"请输入随访标题"}],planContent:[{required:!0,message:"请输入随访内容"}]}}),mounted(){this.onLoad()},methods:{onLoad(){this.$nextTick(async()=>{if(await this.getPlanWayList(),this.checkClintIds=this.$store.state.intervention.checkUserList.map(e=>e.clientId),2===this.modalType?this.getDetail():3===this.modalType&&this.getDetailTogether(),"2"===this.addType&&(this.form.planDoctor=this.$store.state.user.userId,this.form.planDoctorName=this.$store.state.user.userName),2===this.editType){this.form.planDoctor=this.propsData.planUserId,this.form.planDoctorName=this.propsData.planUserName;const e={id:this.propsData.id},t=await this.$api.userFollowInterface.getIntervenePlan(e),{data:a}=t.data;console.log(a),this.form.templateQuestionId=a.templateQuestionId,this.form.templateQuestionName=a.templateQuestionName}})},handlePopoperClose(e){this.$refs.userPopover.doClose(),this.openCheckVisible=!1,this.form.planDoctor=e.id,this.form.planDoctorName=e.realName,this.$refs.form.validateField("clientId")},handleQuestionPopoperClose(e){this.$refs.questionPopover.doClose(),this.openCheckQuestionVisible=!1,this.form.templateQuestionId=e.id,this.form.templateQuestionName=e.name},async getDetail(){const e=Object.assign({},this.propsData);console.log(e);const{planTime:t,planTitle:a,planWay:s,planDoctor:l,planDoctorName:i,planContent:o,templateQuestionId:n,templateQuestionName:r}=e;this.form.planTime=t,this.form.planWay=s,this.form.planDoctor=l,this.form.planDoctorName=i,this.form.planTitle=a,this.form.planContent=o,2!==this.editType&&(this.form.templateQuestionId=n,this.form.templateQuestionName=r)},async getDetailTogether(){let e="";const t=[];this.propsData.forEach(a=>{t.push(a.planContent),e=t.join("\r\n")}),this.form.planContent=e.substr(0,400)},async getPlanWayList(){const e=await this.$api.userFollowInterface.getIntervenePlanWayList(),{data:t}=e.data,a=t.map(e=>{const{id:t,name:a}=e;return{id:t,name:a}});this.form.planWayList=a},onVisible(e){e||this.$jDynamic.hide({component:"InterventionAddMdl"})},save(){this.$refs.form.validate(async e=>{if(e){const e={planTime:this.form.planTime,planWay:this.form.planWay,planDoctor:this.form.planDoctor,planDoctorName:this.form.planDoctorName,planTitle:this.form.planTitle,planContent:this.form.planContent,templateQuestionId:this.form.templateQuestionId,templateQuestionName:this.form.templateQuestionName};1===this.modalType||3===this.modalType?e.planId=(new Date).getTime():2===this.modalType&&(this.id&&(e.id=this.id),e.planId=this.planId||(new Date).getTime()),this.confirmfunc&&this.confirmfunc.call(this,e),this.cancel()}})},cancel(){this.show=!1}}},o=(a("nfy6"),a("KHd+")),n=Object(o.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"el-plan-setting-mdl",attrs:{title:e.modalTitle,visible:e.show,width:"570px",alignFooter:"right","close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.onVisible}},[a("div",{staticClass:"body"},[a("div",{staticClass:"search-title"},[a("span",[e._v("随访信息")])]),e._v(" "),a("div",{staticClass:"header"},[a("el-form",{ref:"form",staticClass:"form-inline",attrs:{inline:!1,model:e.form,"label-width":"85px",rules:e.rules}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"随访时间：",prop:"planTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择","picker-options":e.pickerStartTime},model:{value:e.form.planTime,callback:function(t){e.$set(e.form,"planTime",t)},expression:"form.planTime"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"随访形式：",prop:"planWay"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.planWay,callback:function(t){e.$set(e.form,"planWay",t)},expression:"form.planWay"}},e._l(e.form.planWayList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"干预人：",prop:"planDoctorName"}},["1"===e.addType?a("el-popover",{ref:"userPopover",attrs:{placement:"right",width:"545",trigger:"click"},on:{show:function(t){e.openCheckVisible=!0},hide:function(t){e.openCheckVisible=!1}}},[e.openCheckVisible?a("manager-list",{attrs:{clientIds:e.checkClintIds,propsType:"doctor"},on:{change:e.handlePopoperClose}}):e._e(),e._v(" "),a("el-input",{staticClass:"select-user-trigger",staticStyle:{width:"100%"},attrs:{slot:"reference",disabled:"",placeholder:"选择干预人"},slot:"reference",model:{value:e.form.planDoctorName,callback:function(t){e.$set(e.form,"planDoctorName",t)},expression:"form.planDoctorName"}},[a("i",{class:"el-icon-arrow-"+(e.openCheckVisible?"up":"down"),attrs:{slot:"suffix"},slot:"suffix"})])],1):a("el-input",{staticClass:"select-user-trigger",staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:""},model:{value:e.form.planDoctorName,callback:function(t){e.$set(e.form,"planDoctorName",t)},expression:"form.planDoctorName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"随访标题：",prop:"planTitle"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:40,placeholder:"请输入"},model:{value:e.form.planTitle,callback:function(t){e.$set(e.form,"planTitle",t)},expression:"form.planTitle"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"随访内容：",prop:"planContent"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:4,placeholder:"请输入",maxlength:400,"show-word-limit":""},model:{value:e.form.planContent,callback:function(t){e.$set(e.form,"planContent",t)},expression:"form.planContent"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"随访问卷："}},[a("el-popover",{ref:"questionPopover",attrs:{placement:"top-start",width:"565",trigger:"click"},on:{show:function(t){e.openCheckQuestionVisible=!0},hide:function(t){e.openCheckQuestionVisible=!1}}},[e.openCheckQuestionVisible?a("question-open",{on:{change:e.handleQuestionPopoperClose}}):e._e(),e._v(" "),a("el-input",{staticClass:"select-user-trigger",staticStyle:{width:"100%"},attrs:{slot:"reference",disabled:"",placeholder:"请选择"},slot:"reference",model:{value:e.form.templateQuestionName,callback:function(t){e.$set(e.form,"templateQuestionName",t)},expression:"form.templateQuestionName"}},[a("i",{class:"el-icon-arrow-"+(e.openCheckQuestionVisible?"up":"down"),attrs:{slot:"suffix"},slot:"suffix"})])],1)],1)],1)],1)],1)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"cancelBtn",attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"sureBtn",attrs:{size:"small",type:"primary"},on:{click:e.save}},[e._v("确定")])],1)])}),[],!1,null,"61f4c8cc",null);t.a=n.exports}}]);