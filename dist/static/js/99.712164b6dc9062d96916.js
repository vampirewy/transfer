(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{"0Urv":function(t,e,a){},"9mMh":function(t,e,a){},Ae3Q:function(t,e,a){"use strict";a.r(e);var s=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divTitle"},[e("span",[e("img",{attrs:{src:a("OygJ"),alt:""}})]),this._v("\n    自定义问卷\n  ")])}],i=a("IZzX"),o=a("M07H"),r=a("pvXR"),l=a("aVcm"),n=a("s8mG"),c=a("5i/l"),u=a.n(c),p={name:"MedicalHistorySelectUser",data:()=>({keyword:"",questionType:"",tableData:[],total:0,currentPage:1,pageSize:5,selectRadio:""}),mounted(){this.queryList()},methods:{handleRowClick(t){this.$emit("change",t)},handleCurrentChange(t){this.currentPage=t,this.queryList()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.queryList()},search(){this.keyword="",this.currentPage=1,this.queryList()},reset(){this.currentPage=1,this.queryList()},async queryList(){const t=await this.$api.userFollowInterface.getTemplateQuestionListPage({name:this.keyword,questionType:this.questionType,pageNo:this.currentPage,pageSize:this.pageSize}),{data:e}=t.data;e&&(this.tableData=e.data||[],this.total=e.total)}}},d=(a("ac53"),a("KHd+")),m=Object(d.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"medical-history-select-user"},[s("div",{staticClass:"divTop",staticStyle:{margin:"-15px 0 15px 0"}},[s("div",{staticClass:"searchCondition"},[s("div",{staticClass:"searchLeft"},[s("div",[s("span",[t._v("问卷类型：")]),t._v(" "),s("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择"},model:{value:t.questionType,callback:function(e){t.questionType=e},expression:"questionType"}},[s("el-option",{key:"4",attrs:{label:"随访问卷",value:"4"}})],1)],1),t._v(" "),s("div",{staticClass:"searchInputFormItem"},[s("el-input",{attrs:{placeholder:"输入问卷名称搜索"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t._v(" "),s("span",{staticClass:"searchBtnImgSpan",on:{click:t.search}},[s("img",{staticClass:"searchBtnImg",attrs:{src:a("RQrH")}})])],1)]),t._v(" "),s("div",{staticClass:"searchRight"},[s("div",{staticClass:"buttones"},[s("div",{staticClass:"searchFor",on:{click:t.search}},[s("img",{attrs:{src:a("nc5h"),alt:""}})]),t._v(" "),s("div",{staticClass:"resetAll",on:{click:t.reset}},[t._v("重置")])])])])]),t._v(" "),s("el-table",{staticClass:"openTable",attrs:{data:t.tableData},on:{"row-click":t.handleRowClick}},[s("el-table-column",{attrs:{width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-radio",{attrs:{label:e.row.id},model:{value:t.selectRadio,callback:function(e){t.selectRadio=e},expression:"selectRadio"}},[t._v(" ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"问卷名称"}}),t._v(" "),s("el-table-column",{attrs:{prop:"sortTypeName",label:"问卷分类"}}),t._v(" "),s("el-table-column",{attrs:{prop:"createdByName",label:"创建人"}}),t._v(" "),s("el-table-column",{attrs:{prop:"writeTotal","min-width":"150",label:"已填人数"}})],1),t._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev,pager,next,jumper,total,sizes","page-sizes":[5],"pager-count":5,total:t.total,"page-size":t.pageSize,"current-page":t.currentPage},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)}),[],!1,null,"09fd8b0e",null).exports,h={name:"question",components:{report:n.a,QueryPage:i.a,Search:o.a,QueryFilter:r.a,OperateButton:l.a,VisitedQuestionaireOpen:m},data(){return{isTrue:!0,total:0,dataSource:[],gridList:[],formData:{keyWord:"",gender:"",clientGrid:"",source:"",sortType:"",startTime:void 0,endTime:void 0,questionType:4},questionFromList:[],sortTypeList:[],popoverStatus:!1,visible:!1,current:{},params:{pageNo:1,pageSize:15},options:{},types:[],multipleSelection:[],pickerStartTime:{disabledDate:t=>{if(this.formData.endTime){const e=new Date(this.formData.endTime);return t.getTime()>new Date(e).getTime()-828e5}}},pickerEndTime:{disabledDate:t=>{if(this.formData.startTime){const e=new Date(this.formData.startTime);return t.getTime()<new Date(e).getTime()-828e5}}}}},activated(){if(this.getGridList(),this.getQuestionFromList(),this.getSystemParamByCode("ZY007"),localStorage.getItem("homeSearchData")){const t=JSON.parse(localStorage.getItem("homeSearchData"));this.formData.startTime=t.startDate,this.formData.endTime=t.lastDate,this.formData.searchRange=t.searchRange}},destroyed(){localStorage.removeItem("homeSearchData")},methods:{async getGridList(){const t=await this.$api.userManagerInterface.getGridList({pageNo:1,pageSize:1e4}),{data:e}=t.data;this.gridList=e.data},async getQuestionFromList(){const t=await this.$api.health.getQuestionFromList({pageNo:1,pageSize:1e4}),{data:e}=t.data;this.questionFromList=e},async getSystemParamByCode(t){const e=await this.$api.userManagerInterface.getSystemParamByCode(t),{data:a}=e.data;this.sortTypeList=a},handleSelectionChange(t){this.multipleSelection=t},handlePopoperClose(t){this.$refs.userPopover.doClose(),this.popoverStatus=!1,console.log(t),this.$router.push({name:"custom_questionnaire_edit",params:{type:"edit",qusType:4,templateQuestionId:t.id}})},reset(){this.params.pageNo=1,this.formData.keyWord="",this.formData.gender="",this.formData.clientGrid="",this.formData.source="",this.formData.sortType="",this.formData.startTime=void 0,this.formData.endTime=void 0,this.fetch()},search(t=1){this.params.pageNo=t,this.fetch()},handleAddCheck(t){this.$router.push({name:"health_questionnaire_edit",params:{type:"edit",qusType:Number(t)}})},handleEditCheck(){1===this.multipleSelection.length?this.$router.push({name:"health_questionnaire_edit",params:{type:"edit",qusType:this.multipleSelection[0].questionType,id:this.multipleSelection[0].id}}):this.$message({message:"请选择一条记录编辑",type:"warning"})},remove({row:t}){this.$confirm("改操作无法撤销, 是否删除?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(()=>{this.$api.health.remove(t.id).then(({data:t})=>{200===t.code&&(this.$message.success("操作成功"),this.fetch())})})},handleSomeRemove(){0!==this.multipleSelection.length?this.$confirm(`<div class="delete-text-content"><img class="delete-icon" src="${u.a}"/><span>该操作无法撤销，是否确认批量删除！</span></div>`,"删除提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"message-box-customize",showClose:!0}).then(async()=>{const t=[];this.multipleSelection.forEach(e=>{t.push(e.id)});const e=t;return await this.$api.health.removeSome(e),this.$message.success("操作成功"),this.fetch()}):this.$message({message:"请选择要删除的记录",type:"warning"})},fetch(){this.formData.startTime&&(this.formData.startTime=this.formData.startTime+" 00:00:00"),this.formData.endTime&&(this.formData.endTime=this.formData.endTime+" 23:59:59"),this.$api.health.fetch(Object.assign(this.params,this.formData)).then(({data:t})=>{this.total=t.data.total,this.dataSource=t.data.data})},getReport({row:t}){Object.assign(this.current,t),this.visible=!0},async getQuestionType(){await this.$api.health.getQuestionType().then(t=>{console.log(t),this.types=t,t.forEach(t=>{this.options[t.paramValue]=t.name})})},upMore(){this.isTrue=!this.isTrue}},beforeRouteEnter(t,e,a){a(t=>{t.fetch()})}},v=(a("qUB3"),Object(d.a)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"divTop"},[t._m(0),t._v(" "),s("div",{staticClass:"searchCondition"},[s("div",{staticClass:"searchLeft"},[s("div",{staticClass:"searchInputFormItem"},[s("el-input",{attrs:{placeholder:"姓名/编号/单位"},model:{value:t.formData.keyWord,callback:function(e){t.$set(t.formData,"keyWord",e)},expression:"formData.keyWord"}}),t._v(" "),s("span",{staticClass:"searchBtnImgSpan",on:{click:function(e){return t.search(1)}}},[s("img",{staticClass:"searchBtnImg",attrs:{src:a("RQrH")}})])],1),t._v(" "),s("div",[s("span",[t._v("客户性别：")]),t._v(" "),s("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.formData.gender,callback:function(e){t.$set(t.formData,"gender",e)},expression:"formData.gender"}},[s("el-option",{key:"1",attrs:{label:"男",value:"1"}}),t._v(" "),s("el-option",{key:"2",attrs:{label:"女",value:"2"}})],1)],1),t._v(" "),s("div",[s("span",[t._v("人员类别：")]),t._v(" "),s("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.formData.clientGrid,callback:function(e){t.$set(t.formData,"clientGrid",e)},expression:"formData.clientGrid"}},t._l(t.gridList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.gridName,value:t.id}})})),1)],1),t._v(" "),s("div",[s("span",[t._v("问卷来源：")]),t._v(" "),s("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.formData.source,callback:function(e){t.$set(t.formData,"source",e)},expression:"formData.source"}},t._l(t.questionFromList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.paramValue}})})),1)],1)]),t._v(" "),s("div",{staticClass:"searchRight"},[s("div",{staticClass:"buttones"},[s("div",{staticClass:"searchFor",on:{click:function(e){return t.search(1)}}},[s("img",{attrs:{src:a("nc5h"),alt:""}})]),t._v(" "),s("div",{staticClass:"resetAll",on:{click:t.reset}},[t._v("重置")]),t._v(" "),t.isTrue?s("div",{staticClass:"more",on:{click:t.upMore}},[s("span",[t._v(">")]),t._v("\n          展开更多")]):s("div",{staticClass:"more noMore",on:{click:t.upMore}},[s("span",[t._v(">")]),t._v("收起筛选")])])])])]),t._v(" "),t.isTrue?t._e():s("div",{staticClass:"searchCondition",staticStyle:{width:"80%"}},[s("div",{staticClass:"searchLeft",staticStyle:{"padding-left":"5px"}},[s("div",[s("span",[t._v("问卷类型：")]),t._v(" "),s("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.formData.sortType,callback:function(e){t.$set(t.formData,"sortType",e)},expression:"formData.sortType"}},t._l(t.sortTypeList,(function(t){return s("el-option",{key:t.paramValue,attrs:{label:t.name,value:t.paramValue}})})),1)],1),t._v(" "),s("div",[s("span",[t._v("填写日期：")]),t._v(" "),s("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date","value-format":"yyyy-MM-dd","max-date":t.formData.endTime,placeholder:"选择开始日期"},model:{value:t.formData.startTime,callback:function(e){t.$set(t.formData,"startTime",e)},expression:"formData.startTime"}}),t._v(" "),s("span",{staticClass:"timing"},[t._v("-")]),t._v(" "),s("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date","value-format":"yyyy-MM-dd","min-date":t.formData.startTime,placeholder:"选择结束日期"},model:{value:t.formData.endTime,callback:function(e){t.$set(t.formData,"endTime",e)},expression:"formData.endTime"}})],1)])]),t._v(" "),s("div",{staticClass:"topbottomborder"}),t._v(" "),s("div",{staticClass:"divRightTitleDiv"},[s("div",{staticStyle:{margin:"16px 0"}},[t.getAccess("custom_questionnaire_add")?s("el-popover",{ref:"userPopover",attrs:{placement:"bottom-start",width:"650",trigger:"click"},on:{show:function(e){t.popoverStatus=!0},hide:function(e){t.popoverStatus=!1}}},[t.popoverStatus?s("visited-questionaire-open",{on:{change:t.handlePopoperClose}}):t._e(),t._v(" "),s("el-button",{staticClass:"btn-new btnAdd",attrs:{slot:"reference",size:"small"},slot:"reference"},[s("img",{attrs:{src:a("R07p")}}),t._v("新增")])],1):t._e(),t._v(" "),t.getAccess("custom_questionnaire_deleted")?s("el-button",{staticClass:"btn-new btnDel",staticStyle:{"margin-left":"12px"},attrs:{size:"small"},on:{click:t.handleSomeRemove}},[s("img",{attrs:{src:a("IKay")}}),t._v("删除")]):t._e()],1)]),t._v(" "),s("div",{staticClass:"user-follow"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dataSource,align:"center"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),s("el-table-column",{attrs:{label:"客户编号",prop:"clientNo","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.clientNo)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"姓名",prop:"clientName","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"clientName",on:{click:function(a){return t.commonHref.toPersonalHealth(e.row.clientId,t.$router)}}},[t._v("\n                "+t._s(t._f("getResult")(e.row.clientName))+"\n              ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"gender",label:"性别",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResultGender")(e.row.gender)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"年龄",prop:"age"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.age)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"clientGridName",label:"人员类别","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.clientGridName)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"sortTypeName",label:"问卷类型","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.sortTypeName)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"问卷名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.name)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"填写日期",prop:"questionDate","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResultDate")(e.row.questionDate)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"问卷来源",prop:"sourceName","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("getResult")(e.row.sourceName))+"\n        ")]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"gender",label:"份数",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.questionCount)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作",prop:"index",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getAccess("custom_questionnaire_edit")?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.$router.push({name:"custom_questionnaire_edit",params:{type:"edit",qusType:4,templateQuestionId:"1386567482646433793",id:e.row.id}})}}},[t._v("编辑")]):t._e(),t._v(" "),t.getAccess("custom_questionnaire_view")?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.$router.push({name:"health_questionnaire_detail",params:{qusType:e.row.questionType,id:e.row.id}})}}},[t._v("查看")]):t._e()]}}])})],1),t._v(" "),s("div",{staticStyle:{"text-align":"right"}},[s("el-pagination",{staticStyle:{"margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next, jumper, total, sizes",total:t.total,"page-size":t.params.pageSize,pageSizes:[15]},on:{"current-change":t.search}})],1),t._v(" "),s("report",{attrs:{visible:t.visible,id:t.current.id},on:{cancel:function(e){t.visible=!1}}})],1)])}),s,!1,null,"1066066c",null));e.default=v.exports},ac53:function(t,e,a){"use strict";a("9mMh")},qUB3:function(t,e,a){"use strict";a("0Urv")}}]);