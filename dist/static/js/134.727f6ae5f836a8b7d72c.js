(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{DNHC:function(e,t,r){"use strict";r.r(t);let s=null;var o={name:"ForgetPassowrd",data(){return{forgetForm:{tel:"",code:"",newPassword:"",confirmPassword:"",number1:"",number2:"",number3:"",number4:"",number5:"",number6:""},forgetRules:{tel:[{required:!0,message:"手机号码不能为空"}],code:[{required:!0,message:"验证码不能为空"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,t,r)=>t?this.forgetForm.newPassword&&this.forgetForm.newPassword!==t?r(new Error("二次密码不一致，请重新输入")):void r():r(new Error("确认密码不能为空")),trigger:"blur"}]},time:0,step:1}},watch:{forgetForm:{handler(){const{number1:e,number2:t,number3:r,number4:s,number5:o,number6:n}=this.forgetForm;this.forgetForm.code=`${e}${t}${r}${s}${o}${n}`},deep:!0}},methods:{handleNumberKeyDown(e,t){"Backspace"===e.key&&t>1&&!this.forgetForm["number"+t]&&this.$refs.numberInput[t-2].focus()},handleNumberFocus(e){this.codeIndex=e},handleNumberInput(e,t){this.forgetForm["number"+t]=e.replace(/[^0-9]/g,""),this.forgetForm["number"+t]&&t<6&&this.$refs.numberInput[t].focus()},sendCode(){const{tel:e}=this.forgetForm;e?this.$api.loginInterface.sendCode({mobile:e,type:"resetPassword"}).then(()=>{this.$message.success("验证码已发送！"),this.step=2,this.time=60,s=setInterval(()=>{this.time--,this.time<=0&&clearInterval(s)},1e3)}):this.$message.error("请先填写手机号码！")},nextStep(e){let t=0;if(this.$refs.forgetForm.validateField(e,e=>{e&&t++}),!t){const{tel:e,code:t}=this.forgetForm;this.$api.loginInterface.verifyCode({mobile:e,code:t}).then(()=>{this.step=3,this.$nextTick(()=>{this.$refs.forgetForm.clearValidate()})})}},finish(){this.$refs.forgetForm.validate(e=>{if(e){const{tel:e,code:t,newPassword:r}=this.forgetForm;this.$api.loginInterface.resetPassword({mobile:e,smsCode:t,newPassword:r}).then(()=>{this.$message.success("操作成功！"),this.$router.push("/login")})}})}},beforeDestroy(){s&&clearInterval(s)}},n=(r("suyd"),r("KHd+")),a=Object(n.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"forget-password-page"},[r("div",{staticClass:"forget-content"},[r("div",{staticClass:"forget-content-wrapper"},[r("div",{staticClass:"content-main"},[r("div",{staticClass:"content-center"},[e._m(0),e._v(" "),r("el-form",{ref:"forgetForm",staticClass:"inputCommon",attrs:{model:e.forgetForm,rules:e.forgetRules}},[r("h3",{staticClass:"forget-title"},[e._v("\n              "+e._s(3===e.step?"输入新密码":2===e.step?"输入验证码":"找回密码")+"\n            ")]),e._v(" "),1===e.step?[r("el-form-item",{attrs:{label:"手机号码",prop:"tel"}},[r("el-input",{attrs:{"validate-event":!1,maxlength:"11",placeholder:"请输入手机号码"},model:{value:e.forgetForm.tel,callback:function(t){e.$set(e.forgetForm,"tel",t)},expression:"forgetForm.tel"}})],1),e._v(" "),r("div",{staticClass:"buttons"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.back()}}},[e._v("取消")]),e._v(" "),e.time<=0?r("el-button",{staticClass:"send-code",attrs:{type:"primary",size:"small",disabled:!e.forgetForm.tel},on:{click:e.sendCode}},[e._v("发送验证码")]):r("el-button",{staticClass:"send-code",attrs:{disabled:"",size:"small"}},[e._v(e._s(e.time)+"s")])],1)]:e._e(),e._v(" "),2===e.step?[r("el-form-item",{attrs:{label:"验证码",prop:"code"}},[r("div",{staticClass:"number-inputs"},e._l(6,(function(t){return r("el-input",{key:t,ref:"numberInput",refInFor:!0,attrs:{maxlength:"1","validate-event":!1},on:{focus:function(){return e.handleNumberFocus(t)},input:function(r){return e.handleNumberInput(r,t)}},nativeOn:{keydown:function(r){return s=r,e.handleNumberKeyDown(s,t);var s}},model:{value:e.forgetForm["number"+t],callback:function(r){e.$set(e.forgetForm,"number"+t,r)},expression:"forgetForm['number' + index]"}})})),1)]),e._v(" "),r("div",{staticClass:"buttons"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.step=1}}},[e._v("上一步")]),e._v(" "),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.nextStep(["tel","code"])}}},[e._v("下一步")])],1)]:e._e(),e._v(" "),3===e.step?[r("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[r("el-input",{attrs:{type:"password","validate-event":!1,placeholder:"新的密码"},model:{value:e.forgetForm.newPassword,callback:function(t){e.$set(e.forgetForm,"newPassword",t)},expression:"forgetForm.newPassword"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[r("el-input",{attrs:{type:"password","validate-event":!1,placeholder:"确认密码"},model:{value:e.forgetForm.confirmPassword,callback:function(t){e.$set(e.forgetForm,"confirmPassword",t)},expression:"forgetForm.confirmPassword"}})],1),e._v(" "),r("div",{staticClass:"buttons"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.step=2}}},[e._v("上一步")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.finish}},[e._v("确定")])],1)]:e._e()],2)],1)])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"forget-header"},[t("h3",[this._v("WELCOME TO")]),this._v(" "),t("h2",{staticClass:"login-brand"},[this._v("健康管理系统")])])}],!1,null,"5eae3bbc",null);t.default=a.exports},suyd:function(e,t,r){"use strict";r("wrZm")},wrZm:function(e,t,r){}}]);