(window.webpackJsonp=window.webpackJsonp||[]).push([[138],{"5x0V":function(t,e,s){"use strict";s.r(e);var i=s("IZzX"),a=s("M07H"),o=s("pvXR"),n=s("6vIJ"),r=s.n(n),l=s("Wgwc"),c=s("2lUt"),h={name:"index",components:{Search:a.a,QueryPage:i.a,QueryFilter:o.a,editDetail:c.a},data:()=>({isstate:!0,isTrue:!0,value:!0,total:0,gridList:[],doctorList:[],dataSource:[],chooseUserList:[],dialogTableVisible:!1,clientId:"",formData:{gridId:"",doctorId:"",keywords:"",gender:"",genderType:"",startTime:"",endTime:""},params:{pageNo:1,pageSize:15,type:0},isCollapse:!0,modalVisible:!1,currentValue:{}}),methods:{upMore(){this.isTrue=!this.isTrue},InterventionAdd(){this.modalVisible=!0},cancel(){this.modalVisible=!1},async getGridList(){const t=await this.$api.userManagerInterface.getGridList({pageNo:1,pageSize:1e4}),{data:e}=t.data;this.gridList=e.data},async getDoctor(){const t=await this.$api.doctorInterface.getDoctorList({pageNo:1,pageSize:1e4}),{data:e}=t.data;this.doctorList=e.data},handleEditCheck(){},handleSomeRemove(){if(!this.chooseUserList.length)return void this.$message.error("请选择需要删除客户");const t=`<div class="delete-text-content">\n        <img class="delete-icon" src="${r.a}"/><span>该操作无法撤销，是否确认删除！</span></div>\n        `;this.$confirm(t,"删除提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"message-box-customize",showClose:!0}).then(()=>{const t={clientIdList:this.chooseUserList.map(t=>t.id)};this.$api.userManagerInterface.deleteClientInfo(t).then(({data:t})=>{200===t.code&&(this.$message.success("操作成功"),this.search(),this.chooseUserList=[],this.$refs.multipleTable.clearSelection())})})},reset(){Object.assign(this.$data,this.$options.data()),this.getUserList(),this.getGridList()},onChangePage(t=1){this.params.pageNo=t,this.getUserList()},search(){const t=this.formData.startTime&&(!this.formData.startTime||!this.formData.endTime),e=this.formData.endTime&&(!this.formData.startTime||!this.formData.endTime);t||e?this.$message.error("查询必须包括开始时间和结束时间"):this.formData.startTime>this.formData.endTime?this.$message.error("查询的开始时间不可大于结束时间"):(this.formData.startTime&&this.formData.endTime&&(this.formData.startTime=l(this.formData.startTime).format("YYYY-MM-DD"),this.formData.endTime=l(this.formData.endTime).format("YYYY-MM-DD")),this.params.pageNo=1,this.getUserList())},handleSelectionChange(t){this.chooseUserList=t},assign({row:t={}}){t.id&&(this.chooseUserList=[t]),this.chooseUserList.length?(this.clientId=this.chooseUserList[0].id,this.dialogTableVisible=!0):this.$message.warning("请选择客户")},submitAssign(t){if(!t.length)return void this.$message.warning("请选择医生");this.dialogTableVisible=!1;const e=t.filter(t=>1===t.selectType).map(t=>t.id),s=t.filter(t=>2===t.selectType).map(t=>t.id);this.submit({clientIdList:this.chooseUserList.map(t=>t.id),userIdList:e,workIdList:s,type:2})},claim({row:t={}}){if(t.id)this.chooseUserList=[t];else if(!this.chooseUserList.length)return void this.$message.warning("请选择客户");this.$confirm(`<div class="delete-text-content"><img class="delete-icon" src="${r.a}"/><span>您确定要删除该病人吗？</span></div>`,"提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"message-box-customize",showClose:!0}).then(()=>{const t={clientIdList:this.chooseUserList.map(t=>t.id)};this.$api.userManagerInterface.deleteClientInfo(t).then(({data:t})=>{200===t.code&&(this.$message.success("操作成功"),this.getUserList(),this.chooseUserList=[],this.$refs.multipleTable.clearSelection())})})},submit(t){this.$api.userManagerInterface.claim(t).then(({data:t})=>{200===t.code&&(this.$message.success("操作成功"),this.search(),this.chooseUserList=[],this.$refs.multipleTable.clearSelection())})},changeStatus({row:t={}},e){const s=t;this.$api.userManagerInterface.editUserStatus({id:s.id,state:e}).then(({data:t})=>{200===t.code&&(this.$message.success("操作成功"),s.state=e)})},getUserList(){this.$api.userManagerInterface.fetchUserList(Object.assign(this.params,this.formData)).then(({data:t})=>{t.success&&(this.total=t.data.total,this.dataSource=t.data.data)})}},mounted(){this.getUserList(),this.getGridList(),this.getDoctor()}},d=(s("hpEX"),s("KHd+")),m=Object(d.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"userManage"},[t._m(0),t._v(" "),i("el-row",[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"isEnabled"},[i("span",[t._v("模版名称：")]),t._v("白内障")])]),t._v(" "),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"isEnabled"},[i("span",[t._v("是否启用：")]),t._v(" "),i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#13ce66"},on:{change:function(e){return t.changeStatus()}},model:{value:t.isstate,callback:function(e){t.isstate=e},expression:"isstate"}})],1)])],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"isEnabled"},[i("span",[t._v("模版条件：")]),t._v("1231231312123131212")])])],1),t._v(" "),t._m(1),t._v(" "),i("div",{staticClass:"divRightTitleDiv"},[i("div",[i("el-button",{staticClass:"btn-new btnAdd",staticStyle:{margin:"16px 0"},attrs:{size:"small"},on:{click:function(e){return t.InterventionAdd()}}},[i("img",{attrs:{src:s("R07p")}}),t._v("新增")]),t._v(" "),t.getAccess("customer_pool_batch_delete")?i("el-button",{staticClass:"btn-new btnDel",attrs:{size:"small"},on:{click:t.handleSomeRemove}},[i("img",{attrs:{src:s("IKay")}}),t._v("删除")]):t._e()],1)]),t._v(" "),i("div",[i("el-table",{ref:"multipleTable",attrs:{data:t.dataSource,align:"center","show-overflow-tooltip":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection","min-width":"40"}}),t._v(" "),i("el-table-column",{attrs:{label:"阶段",prop:"clientNo","min-width":"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v("\n                "+t._s(e.row.clientNo)+"\n              ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"干预形式",prop:"createTime","min-width":"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"主要内容",prop:"createTime","min-width":"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"干预提示",prop:"createTime","min-width":"80","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"index",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getAccess("customer_pool_edit")?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.edits()}}},[t._v("编辑")]):t._e(),t._v(" "),i("el-button",{staticStyle:{color:"#DDE0E6"},attrs:{type:"text",size:"small"}},[t._v("|")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.claim(e)}}},[t._v("查看")])]}}])})],1),t._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("el-pagination",{staticStyle:{"margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next, jumper, total, sizes",total:t.total,pageSizes:[15],"page-size":15},on:{"current-change":t.onChangePage}})],1)],1),t._v(" "),i("edit-detail",{attrs:{visible:t.modalVisible,value:t.currentValue},on:{cancel:t.cancel}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-title"},[e("div",{staticClass:"line"}),this._v(" "),e("h3",{staticClass:"name"},[this._v("编辑计划")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-title"},[e("div",{staticClass:"line"}),this._v(" "),e("h4",{staticClass:"name"},[this._v("计划列表")])])}],!1,null,"12274f89",null);e.default=m.exports},d2t8:function(t,e,s){},hpEX:function(t,e,s){"use strict";s("d2t8")}}]);