(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"1c3q":function(t,e,a){"use strict";a("kD45")},"1nBH":function(t,e,a){"use strict";a("jd71")},"6MGy":function(t,e,a){"use strict";a("ULPV")},"9uph":function(t,e,a){},Bm3U:function(t,e,a){},R9Xx:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAADUUlEQVRIS7WWTYgbdRTAf2+S7Ga1aBHcKttMQCnrsbcKloIgtPUgeBD0oGBcPBQEq3XxZupFhbVVxMhukomeBPGiSNEWwUM9CFrYipa4ina3q7vbfNT9ymwyM69Mtluzm0kyofVd5vA+fv/3fx/zF/oUreSexllJU/v5S0la4326I/04qKpQyRZRYx/2xQbiPCgjmbl+YvQHLFuHUe/rJsBZgsbM+5IovPz/AUvZcyCPbQI8qP20jkRN2fthOSw0dIa6nB+lwSX8a92SxhWoz70pyfwbtx9Yzk+i+uK2wOqA/WOFwYGkDGdWw0BDZajVwm5cZwFksC1o/Q9wFl8V0zp1+4CV3Dge7wQG9GpgX5gnYT4gcrLeC9ozQ9XPIpSrSxC5p2Mw+1dwrx3HTGR6QW8CtfzSXdR3HYTBQxix/RDbhwzswYjfAdGeB8OzQVc8Nn77E6WIGMXm15AicaMo90794x9YdPGtaYyhh5D4AER73Uh3fWMB/JoGiqwAZ0WvfrCADO25NdIN79pF8Py4nUSyomuT97PuziADd94S1F0Fe7oLSz4lceTZZm10OTPKhjGNRNvbPuwpmo1T7XSdn2Oaz4iknf+a5t/JAzTkPBj9F9K9BvYvHUrHFyRiT4lMNZpN02qllamjePIViBE2MXBh/QJo4AiewTSfbB2VtnbXavY5POPjbTuzG92+BG6l3UI4RyL5hEjablUGzpeWJschErxZWr03fvfXWhDsO2T345I4Xdup7DjQevWjRSQ2HJicerAxA26pQ92M18TMTwQpOwNLU3UwYm1O3ir4mXlr3UagIKaVCg3U0icj4P/sWsRfXc48+Nukl4j8IKb1cHhgNf8oTuNbtCa4y5vz5X/RXqgt/bIkC3eHB/79QpKG91fY6IF2kUhC9ua239LOOdxy1LnUUTw906VIxU2djna0ETkspnU2VJfqbOoVVN8N6PdFhDQJM9fUzc2OoaRBA5a/HJek9V444OXns8DYTWNhDZUJhuITO98uunRsFzX7BKInUFp+AJKVpLX9DdTxSi+nzoM+gogD5IjHT8pwpmt76tKx+7Bt//U2hmoU5HtJWgfDZTib+gZYJ8LrMmLdqFe4FtL51Cgub4MOiVk4stPrOttVSaHOYlEhAAAAAElFTkSuQmCC"},ULPV:function(t,e,a){},VB2b:function(t,e,a){"use strict";a("hAs4")},ZMWN:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAD3UlEQVRYR9WXXWgcVRiG3+/sZuOi20jbGHrVqlAIRUt2m6r1xoJmSYmE7OzsbgSxKkW8EKw3KvhTtaAIUkHwQoIWim2yu7NpNaiJ0FTaVCvZCRX8QURaBFt/LmwSWzbZnVcmMXGzM7M/JFCcyzPfed9nvvN955wRXOdHrrM//l8Ad6eGt8yVSj0gohDZAmLTQgYFl0BegGA04PONfDXYd6HezNaVgXAy146SdZBArB5hAXLwqRfModj3teKrApCUHQnjRQIvkfDVEit/L4KSAK9OprXXRIRecz0B7tHPBgu4dISk1ohxZayIGM3Y9PCXmV3X3HQ8AcIJ4xgtplZjvjRXlAyaaa2/boCInn3OIl5fC/MlDSV4Pp+Jv+HIUOVAx0PGZszzRxABJ4AUADZXAxPIDMGQI0YwhybZOnVUu7iiVioDw7rxAcm9Lmt5phmBVIEFg8BdrhAiXzQFRStetY4S6HLROGxmtEc9Ae7bO3zz9Kz1B0G/c7LqNjOxzyL65y3kldFKCAFObwyGuseORP/uTB3fVSwWJ5zpluK6m1TrqcN9fy3XR3lQRzyXAqxj7l+HWQXVnc/EzrhAnG2RDdFTmd2zO5O57fOWdRLEevelUv1T2digO4BuDIB83HONxQkBEQZD/q6J93tnIvrxO8jSOMENnhpKBqbS2j5XgHA8a6fWsXYrxCog/IF5nvtwz3Rn/0fbisW5cRCt1YsUY2Y2HvUCOE/gzprtJ5iFr2n31GDvpB27M5nbOl/iaYC31JorwDdmNr7dHUA3JklG6hA5J9ISzWceuGLHehWmm46I5M2MtsMrAx8T6KmRwmVz+5BS5PrJtDZRL4QAI2Y2/qA7QMI4RItPewEIsMKcFscB3lilO5z7kZK3zbS23xUgkhzuskqlUdfUuZmTbQuxLt3htVkpny+aH+obcwXofuqT5t8uX/2dxDoHhL+p0y46O+0LX75k/p/S8j5hF2XRsr6rPMJFMH072lszmW1zrgD2YDhhHKDFlysBRORXAk8CeM9hXgYhSj0CiwdJtjs0lLxiprUD5eOO4/jex06Ers0Ufya5sVY3NPJeRP4Mhvy32RtWVYCFLCRzPbSsEyBUIyaesQJLlOo1h2Ijjqx4TVrLO4HXXWCxfqs8HXr2GQHebPQ+uFwS9r2Q8mw+q71VpbWrJ7kzYdxfsjBAcHMjyyEiv0C4z0zHXdvaswvcTHT928BP/OEJCPeDuLUayKKxHGpru+HdT9/ZU6gFXdd/QbnIv6deVCA2yOKPCXkZgot+pca+Hoqdr2VaswsaEVhtbMMZWK1h3W241kZeev8AIRG2MBvZVPkAAAAASUVORK5CYII="},d4GS:function(t,e,a){"use strict";a.r(e);var s=a("aVcm"),i={name:"Intervention_tab_mdl",data:()=>({menuNum:0,active:0,tableData:[],form:{templateId:"",templateList:[]},total:0,pageNo:1,multipleSelectionAll:[],multipleSelection:[],idKey:"id"}),mounted(){this.getTemplateList()},methods:{clickMenu(t,e){this.changePageCoreRecordData(),this.total=0,this.active=t,this.form.templateId=e,this.pageNo=1,this.getList()},setSelectRow(){if(!this.multipleSelectionAll||this.multipleSelectionAll.length<=0)return void this.$refs.table.clearSelection();const t=this.idKey,e=[];this.multipleSelectionAll.forEach(a=>{e.push(a[t])}),this.$refs.table.clearSelection();for(let a=0;a<this.tableData.length;a++)e.indexOf(this.tableData[a][t])>=0&&this.$refs.table.toggleRowSelection(this.tableData[a],!0)},changePageCoreRecordData(){const t=this.idKey,e=this;if(this.multipleSelectionAll.length<=0)return void(this.multipleSelectionAll=this.multipleSelection);const a=[];this.multipleSelectionAll.forEach(e=>{a.push(e[t])});const s=[];this.multipleSelection.forEach(i=>{s.push(i[t]),a.indexOf(i[t])<0&&e.multipleSelectionAll.push(i)});const i=[];this.tableData.forEach(e=>{s.indexOf(e[t])<0&&i.push(e[t])}),i.forEach(s=>{if(a.indexOf(s)>=0)for(let a=0;a<e.multipleSelectionAll.length;a++)if(e.multipleSelectionAll[a][t]===s){e.multipleSelectionAll.splice(a,1);break}})},getAllSelectionData(){this.changePageCoreRecordData()},chooseCheckBox(t){const e=[...this.$store.state.intervention.tplList];this.multipleSelection=t,this.multipleSelection.forEach(t=>{let a=!1;e.forEach(e=>{t.id===e.id&&(a=!0)}),!1===a&&e.push(t)}),this.$store.dispatch("intervention/setTplList",e)},async getTemplateList(){const t={clientId:this.$store.state.intervention.checkUserList.map(t=>t.clientId)[0],state:1,keywords:"",pageNo:1,pageSize:1e4},e=await this.$api.interventionTemplateInterface.getInterveneTemplateListPage(t),{data:a}=e.data;a&&(this.form.templateList=a.data||[],this.form.templateList.length>0&&(this.form.templateId=this.form.templateList[0].id,this.getList()))},async getList(){const t={interveneTemplateId:this.form.templateId,pageNo:this.pageNo,pageSize:10},e=await this.$api.interventionTemplateInterface.getInterveneTemplatePlanListPage(t),{data:a}=e.data;this.tableData=a.data||[],this.tableData.forEach(t=>{const e=t;e.planTitle=e.title,e.planDoctor=this.$store.state.user.userId,e.planDoctorName=this.$store.state.user.userName,e.planTime=e.planDate}),this.total=a.total,setTimeout(()=>{this.setSelectRow()},100)},getLook(t){this.$router.push({name:"report_edit",params:{id:""+t.id}})},pageClick(t){this.changePageCoreRecordData(),this.pageNo=t,this.getList()},resetMultipleSelectionAll(t){const e=[];this.changePageCoreRecordData(),this.multipleSelectionAll.forEach(a=>{let s=!1;t.forEach(t=>{t===a.id&&(s=!0)}),!1===s&&e.push(a)}),this.multipleSelectionAll=e,this.setSelectRow()}}},l=(a("1c3q"),a("KHd+")),n=Object(l.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"intervention_tab_div"},[s("div",{staticClass:"intvTmpl_left"},[s("div",{staticClass:"intvTmpl_left_title"},[t._v("干预模板菜单")]),t._v(" "),s("ul",{staticClass:"intv_menulist"},t._l(t.form.templateList,(function(e,i){return s("li",{key:e.id,class:{active:t.active===i},attrs:{title:t.active===i?e.name+"("+t.total+")":e.name},on:{click:function(a){return t.clickMenu(i,e.id)}}},[1===e.checked?s("img",{staticClass:"star",attrs:{src:a("R9Xx")}}):t._e(),t._v("\n      "+t._s(e.name)+" "),t.active===i&&0!==t.total?s("span",[t._v("("+t._s(t.total)+")")]):t._e()])})),0)]),t._v(" "),s("div",{staticClass:"follow-plan"},[s("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.tableData,align:"center"},on:{"selection-change":t.chooseCheckBox}},[s("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),s("el-table-column",{attrs:{prop:"planTime",label:"随访日期",width:"120px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("\n          第"+t._s(e.row.month||"-")+"个月第"+t._s(e.row.day||"-")+"天\n        ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"planWayName",label:"随访形式",width:"100px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.planWayName))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"planTitle",label:"随访标题",width:"100px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.planTitle))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"planContent",label:"随访提示","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.planContent))])]}}])})],1),t._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper, total, sizes",total:t.total,"page-size":10,pageSizes:[10]},on:{"current-change":t.pageClick}})],1)])}),[],!1,null,"8ea229ec",null).exports,o=a("26aT"),r=a("ffTQ"),c=a("dNkx"),p=a("JGWn"),d=a("xqMX"),h=a("z02B"),m=a("Z0dO"),u={name:"Intervention_tab_userdetail_mdl",components:{Disease:o.a,LiftStyle:r.a,UserdetaiIntervene:c.a,RiskAssess:p.a,ImportantIndex:d.a,UserdetailFollowplan:h.a,UserdetailFollowrecord:m.a},data:()=>({menuNum:0,active:0,checkTplPlanList:[],tableData:[],form:{templateId:"",templateList:[],reportAbnormalList:[],questionLifestyle:{questionLifestyle1:{paramValue:""},questionLifestyle2:{paramValue:""},questionLifestyle3:{paramValue:""},questionLifestyle4:{paramValue:""},questionLifestyle5:{paramValue:""}}},assessList:{assess2:[],assess3:[],assess4:[],assess5:[]},total:0,pageNo:1}),mounted(){this.getUserHealthDetail(),this.getAssessReportDetail()},methods:{clickMenu(t,e){this.total=0,this.active=t,this.form.templateId=e,this.pageNo=1,this.getList()},async getUserHealthDetail(){const t={clientId:this.$store.state.intervention.checkUserList[0].clientId,sugarType:2,type:2},e=await this.$api.interventionPlanInterface.getInterveneSchemeCharts(t),{data:a}=e.data;this.form.reportAbnormalList=a.reportAbnormalList||null,this.form.questionLifestyleFamilyHistory=a.questionLifestyleFamilyHistory||null,this.form.questionLifestyleParamValueList=a.questionLifestyleParamValueList||[],this.form.questionLifestyleParamValueList.length>0&&this.form.questionLifestyleParamValueList.forEach(t=>{"j01"===t.paramNo?this.form.questionLifestyle.questionLifestyle1.paramValue=t.valueInfo:"j05"===t.paramNo?this.form.questionLifestyle.questionLifestyle2.paramValue=t.valueInfo:"f01"===t.paramNo?this.form.questionLifestyle.questionLifestyle3.paramValue=t.valueInfo:"g04"===t.paramNo?this.form.questionLifestyle.questionLifestyle4.paramValue=t.valueInfo:"j20"===t.paramNo&&(this.form.questionLifestyle.questionLifestyle5.paramValue=t.valueInfo)})},async getAssessReportDetail(){const t=this.$store.state.intervention.checkUserList[0].clientId,e=await this.$api.health.getAssessReportDetail(t),{data:a}=e.data;a.forEach(t=>{2===t.lv?this.assessList.assess2.push(t.modelName):3===t.lv?this.assessList.assess3.push(t.modelName):4===t.lv?this.assessList.assess4.push(t.modelName):5===t.lv&&this.assessList.assess5.push(t.modelName)})},read(t){this.$emit("read",t)}}},f=(a("6MGy"),Object(l.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"intervention_tab_div"},[t._m(0),t._v(" "),a("disease",{attrs:{reportAbnormalList:t.form.reportAbnormalList}}),t._v(" "),t._m(1),t._v(" "),a("lift-style",{attrs:{questionLifestyle:t.form.questionLifestyle}}),t._v(" "),t._m(2),t._v(" "),a("risk-assess",{staticStyle:{"margin-left":"10px"},attrs:{assessList:t.assessList}}),t._v(" "),t._m(3),t._v(" "),a("important-index",{attrs:{clientId:t.$store.state.intervention.checkUserList[0].clientId}}),t._v(" "),t._m(4),t._v(" "),a("userdetail-followplan"),t._v(" "),t._m(5),t._v(" "),a("userdetail-followrecord")],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px","margin-top":"-3px"}},[e("span",{staticClass:"dianLv"}),this._v("异常信息\n  ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px"}},[e("span",{staticClass:"dianLv"}),this._v("生活方式情况\n  ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px"}},[e("span",{staticClass:"dianLv"}),this._v("慢性病风险评估\n  ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px"}},[e("span",{staticClass:"dianLv"}),this._v("重要指标\n  ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px"}},[e("span",{staticClass:"dianLv"}),this._v("随访计划\n  ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"formSearchTitle",staticStyle:{"font-size":"14px","margin-top":"50px"}},[e("span",{staticClass:"dianLv"}),this._v("随访记录\n  ")])}],!1,null,"a0ee766c",null).exports),v=a("u3Oj"),g={name:"interventionTplOpen",props:{visible:Boolean,value:{default:()=>[]}},data:()=>({formData:{},params:{keywords:"",state:1,pageNo:1,pageSize:5,total:0},tableData:[],map:{},multipleSelectionAll:[],multipleSelection:[],idKey:"id"}),mounted(){this.fetch()},methods:{handleCurrentChange(t){this.search(t)},handleSizeChange(t){this.params.pageSize=t,this.search()},cancel(){this.$emit("cancel")},submit(){this.getAllSelectionData(),this.$emit("change",[...this.multipleSelectionAll]),this.multipleSelectionAll=[],this.$refs.table.clearSelection()},fetch(){this.$api.interventionTemplateInterface.getInterveneTemplateListPage(Object.assign(this.params,this.formData)).then(({data:t})=>{this.params.total=t.data.total,this.tableData=t.data.data,this.tableData.forEach(t=>{this.$set(this.map,t.id,t)}),setTimeout(()=>{this.setSelectRow()},100)})},search(t=1){this.changePageCoreRecordData(),this.params.pageNo=t,this.fetch()},reset(){this.formData.keywords="",this.params.pageNo=1,this.fetch()},setSelectRow(){if(!this.multipleSelectionAll||this.multipleSelectionAll.length<=0)return;const t=this.idKey,e=[];this.multipleSelectionAll.forEach(a=>{e.push(a[t])}),this.$refs.table.clearSelection();for(let a=0;a<this.tableData.length;a++)e.indexOf(this.tableData[a][t])>=0&&this.$refs.table.toggleRowSelection(this.tableData[a],!0)},changePageCoreRecordData(){const t=this.idKey,e=this;if(this.multipleSelectionAll.length<=0)return void(this.multipleSelectionAll=this.multipleSelection);const a=[];this.multipleSelectionAll.forEach(e=>{a.push(e[t])});const s=[];this.multipleSelection.forEach(i=>{s.push(i[t]),a.indexOf(i[t])<0&&e.multipleSelectionAll.push(i)});const i=[];this.tableData.forEach(e=>{s.indexOf(e[t])<0&&i.push(e[t])}),i.forEach(s=>{if(a.indexOf(s)>=0)for(let a=0;a<e.multipleSelectionAll.length;a++)if(e.multipleSelectionAll[a][t]===s){e.multipleSelectionAll.splice(a,1);break}})},getAllSelectionData(){this.changePageCoreRecordData()},handleSelectionChange(t){this.multipleSelection=t}}},b=(a("yH3B"),{name:"InterventionSomecreateMdl",components:{interventionTplOpen:Object(l.a)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"abnormal-popoper"},[s("div",{staticClass:"divTop",staticStyle:{margin:"-15px 0 15px 0"}},[s("div",{staticClass:"searchCondition"},[s("div",{staticClass:"searchLeft"},[s("div",{staticClass:"searchInputFormItem"},[s("el-input",{attrs:{placeholder:"输入模板名称搜索"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),t._v(" "),s("span",{staticClass:"searchBtnImgSpan",on:{click:function(e){return t.search(1)}}},[s("img",{staticClass:"searchBtnImg",attrs:{src:a("RQrH")}})])],1)]),t._v(" "),s("div",{staticClass:"searchRight"},[s("div",{staticClass:"buttones"},[s("div",{staticClass:"searchFor",on:{click:function(e){return t.search(1)}}},[s("img",{attrs:{src:a("nc5h"),alt:""}})]),t._v(" "),s("div",{staticClass:"resetAll",on:{click:t.reset}},[t._v("重置")])])])])]),t._v(" "),s("el-table",{ref:"table",attrs:{data:t.tableData,align:"center"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{label:"模板名称",prop:"name"}}),t._v(" "),s("el-table-column",{attrs:{label:"是否启用",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v("是")])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"性别",prop:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(0===e.row.gender?"不限":1===e.row.gender?"男":2===e.row.gender?"女":"-")+"\n      ")]}}])})],1),t._v(" "),s("el-pagination",{attrs:{background:"",layout:"prev,pager,next,jumper,total",total:t.params.total,"page-size":t.params.pageSize,"current-page":t.params.pageNo,"pager-count":5},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}),t._v(" "),s("div",{staticClass:"footer",staticStyle:{"text-align":"right","margin-top":"20px"}},[s("el-button",{staticClass:"cancelBtn",attrs:{size:"small"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),s("el-button",{staticClass:"sureBtn",attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("确定")])],1)],1)}),[],!1,null,"2531a6ee",null).exports},data:()=>({selectCheck:[],openCheckVisible:!1,tableData:[],form:{interventionTpl:[],planDoctor:"",planDoctorName:""},total:0,pageNo:1}),mounted(){this.getUserInfo(),this.getVuexUserList()},methods:{handleAbnormalSelectChange(t){this.$refs.abnormalPopover.doClose(),this.openCheckVisible=!1,t.forEach(t=>{this.form.interventionTpl.push(t),this.getInterventionTplList(t.id)}),this.form.abnormalName=this.form.interventionTpl.map(t=>t.name).join(",")},handleAbnormalClose(){this.openCheckVisible=!1,this.$refs.abnormalPopover.doClose()},async getUserInfo(){const t=await this.$api.userManagerInterface.getUserInfo(),{data:e}=t.data;this.form.planDoctor=e.userId,this.form.planDoctorName=e.realName},async getInterventionTplList(t){const e={interveneTemplateId:t,pageNo:this.pageNo,pageSize:1e4},a=await this.$api.interventionTemplateInterface.getInterveneTemplatePlanListPage(e),{data:s}=a.data,i=s.data||[];i.forEach(e=>{const a=e;a.planTitle=a.title,a.planDoctor=this.form.planDoctor,a.planDoctorName=this.form.planDoctorName,a.planTime=a.planDate,a.templateId=t}),this.chooseCheckBoxPush(i)},chooseCheckBoxPush(t){const e=[...this.$store.state.intervention.tplList];[...t].forEach(t=>{let a=!1;e.forEach(e=>{t.id===e.id&&(a=!0)}),!1===a&&e.push(t)}),this.$store.dispatch("intervention/setTplList",e)},delinterventionTplOne(t){const e=[...this.$store.state.intervention.tplList].filter(e=>e.templateId!==this.form.interventionTpl[t].id||e.planId);this.$store.dispatch("intervention/setTplList",e),this.form.interventionTpl.splice(t,1);const a=this.form.interventionTpl.map(t=>t.name);this.form.abnormalName=a.join(",")},getVuexUserList(){const t=[...this.$store.state.intervention.checkUserList];this.tableData=t||[]}}}),_=(a("1nBH"),Object(l.a)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tableTopDoDiv",staticStyle:{display:"block","border-right":"1px dashed #DDE0E6","padding-right":"20px"}},[t._m(0),t._v(" "),s("div",{staticClass:"bottom"},[s("div",{staticClass:"action"},[s("span",{staticClass:"name"},[t._v("选择模版：")]),t._v(" "),s("el-popover",{ref:"abnormalPopover",staticStyle:{display:"inline-block",flex:"1"},attrs:{placement:"bottom-start",width:"545",trigger:"click"},on:{show:function(e){t.openCheckVisible=!0},hide:t.handleAbnormalClose}},[t.openCheckVisible?s("intervention-tpl-open",{on:{change:t.handleAbnormalSelectChange,cancel:t.handleAbnormalClose}}):t._e(),t._v(" "),s("el-input",{staticClass:"select-user-trigger",attrs:{slot:"reference",disabled:"",placeholder:"选择模板"},slot:"reference",model:{value:t.form.abnormalName,callback:function(e){t.$set(t.form,"abnormalName",e)},expression:"form.abnormalName"}},[s("i",{class:"el-icon-arrow-"+(t.openCheckVisible?"up":"down"),attrs:{slot:"suffix"},slot:"suffix"})])],1)],1),t._v(" "),s("div",{staticClass:"actionInput"},[s("span",{staticClass:"name"},[t._v("已选模版：")]),t._v(" "),s("div",{staticClass:"sport-form sportTag"},t._l(t.form.interventionTpl,(function(e,i){return s("el-tag",{key:e.id,staticClass:"unusual-tag"},[s("span",[t._v(t._s(e.name))]),t._v(" "),s("img",{attrs:{src:a("ZMWN")},on:{click:function(e){return t.delinterventionTplOne(i)}}})])})),1)])]),t._v(" "),s("div",{staticClass:"divRightTitleDiv"},[s("div",{staticClass:"divRightTitle",staticStyle:{"margin-top":"-10px"}},[t._v("\n      已选客户（"),s("span",{staticStyle:{"margin-right":"0"}},[t._v(t._s(t.tableData.length)+"人")]),t._v("）\n      "),s("div",{staticClass:"titleBiao"})])]),t._v(" "),s("div",{staticClass:"follow-plan"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,align:"center"}},[s("el-table-column",{attrs:{prop:"clientName",label:"姓名",width:"85","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.name)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"gender",label:"性别",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResultGender")(e.row.gender)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"age",label:"年龄",width:"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.age)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"gridName",label:"人员类别","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.gridName)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"workUnitName",label:"单位","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.workUnitName)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"noExecuteCount",label:"计划剩余条数",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("getResult")(e.row.unExecutePlanTotal)))])]}}])})],1)],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divRightTitleDiv"},[e("div",{staticClass:"divRightTitle",staticStyle:{"margin-top":"15px","margin-bottom":"10px"}},[this._v("选择模板\n      "),e("div",{staticClass:"titleBiao"})])])}],!1,null,"36e82766",null).exports),y=a("6vIJ"),w=a.n(y),T={name:"interventionDetail",props:["propsData"],components:{},data(){return{routeType:1,labelPosition:"top",form:{lifeAdvice:"",sportAdvice:[],name:"",startTime:"",endTime:""},pickerStartTime:{disabledDate:t=>{if(this.form.endTime){const e=new Date(this.form.endTime);return t.getTime()>new Date(e).getTime()-828e5}}},pickerEndTime:{disabledDate:t=>{if(this.form.startTime){const e=new Date(this.form.startTime);return t.getTime()<new Date(e).getTime()-828e5}}}}},mounted(){this.onLoad()},methods:{onLoad(){this.getDetail()},async getDetail(){const t={id:this.propsData.interventionId},e=await this.$api.interventionPlanInterface.getInterveneScheme(t),{data:a}=e.data;this.form.name=a.name,a.startTime&&(this.form.startTime=a.startTime.split(" ")[0]),a.endTime&&(this.form.endTime=a.endTime.split(" ")[0]),this.form.lifeAdvice=a.lifeAdvice,a.sportAdvice&&(this.form.sportAdvice=a.sportAdvice.split(","))},cancel(){this.$emit("cancel")}}},C=(a("VB2b"),Object(l.a)(T,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create-edit"},[t._m(0),t._v(" "),a("el-form",{staticClass:"form-inline",attrs:{inline:!1,"label-position":t.labelPosition,model:t.form}},[a("el-form-item",{staticClass:"healthPlanInput",attrs:{label:"方案名称："}},[a("el-input",{staticStyle:{width:"230px"},attrs:{placeholder:"请输入",disabled:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"healthPlanInput",attrs:{label:"开始时间："}},[a("el-date-picker",{staticStyle:{width:"230px"},attrs:{"picker-options":t.pickerStartTime,type:"date","value-format":"yyyy-MM-dd",placeholder:"选择开始时间",disabled:""},model:{value:t.form.startTime,callback:function(e){t.$set(t.form,"startTime",e)},expression:"form.startTime"}})],1),t._v(" "),a("el-form-item",{staticClass:"healthPlanInput",attrs:{label:"结束时间："}},[a("el-date-picker",{staticStyle:{width:"230px"},attrs:{"picker-options":t.pickerEndTime,type:"date","value-format":"yyyy-MM-dd",placeholder:"选择结束时间",disabled:""},model:{value:t.form.endTime,callback:function(e){t.$set(t.form,"endTime",e)},expression:"form.endTime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("div",{staticClass:"top"},[a("div",{staticClass:"action"},[a("span",{staticClass:"name"},[t._v("生活方式")])]),t._v(" "),a("div",{staticClass:"actionInput"},[a("span",{staticClass:"life-advice"},[t._v("生活建议：")]),t._v(" "),a("div",{staticClass:"sport-form sportTag",staticStyle:{height:"auto","min-height":"90px"}},[a("span",{staticClass:"desc"},[t._v(t._s(t.form.lifeAdvice))])])])]),t._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"action"},[a("span",{staticClass:"name"},[t._v("运动方式")])]),t._v(" "),a("div",{staticClass:"actionInput"},[a("div",{staticClass:"sport-form sportTag"},[t._l(t.form.sportAdvice,(function(e){return a("el-tag",{key:e.id,staticClass:"unusual-tag"},[a("span",[t._v(t._s(e))])])})),t._v(" "),0===t.form.sportAdvice.length?a("p",{staticClass:"noneText",staticStyle:{"margin-top":"18px"}},[t._v("\n              请选择运动方式\n            ")]):t._e()],2)])])]),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{staticClass:"cancelBtn",attrs:{size:"small"},on:{click:t.cancel}},[t._v("返回")])],1)],1)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divRightTitle"},[e("span",[this._v("|")]),this._v("查看-干预方案")])}],!1,null,"da1b7fcc",null).exports),S={name:"create_edit",components:{InterventionTabMdl:n,InterventionTabUserdetailMdl:f,InterventionAddMdl:v.a,InterventionSomecreateMdl:_,InterventionDetail:C,OperateButton:s.a},data:()=>({viewIndex:1,InterventionDetailRow:{},activeName:"first",routeType:1,labelPosition:"top",form:{userList:[],planWayList:[]},table:{list:[]},checkPlanList:[],sportAdvice:[]}),computed:{filterTableList(){return[...this.$store.state.intervention.tplList]}},mounted(){this.onLoad()},methods:{onLoad(){this.getPlanWayList();const t=this.$route;"user_follow_create_create"===t.meta.type?this.routeType=1:"user_follow_create_edit"===t.meta.type&&(this.routeType=2,this.getDetail())},rowSameTime({row:t}){const e=[...this.$store.state.intervention.tplList];let a=0;if(e.forEach(e=>{t.planTime===e.planTime&&(a+=1)}),a>=2)return"warning-row"},async getPlanWayList(){const t=await this.$api.userFollowInterface.getIntervenePlanWayList(),{data:e}=t.data,a=e.map(t=>{const{id:e,name:a}=t;return{id:e,name:a}});this.form.planWayList=a},async getDetail(){const t={id:this.$route.params.id},e=await this.$api.userFollowInterface.getIntervenePlan(t),{data:a}=e.data;a&&(this.form.userList=[{name:a.clientName||"",id:a.clientId}],this.table.list=[a],this.table.list.forEach(t=>{const e=t;e.deleted=0,e.edit=!1,e.executeState="2"}))},viewiInterventionDetail(t){this.viewIndex=2,this.InterventionDetailRow={...t}},chooseCheckBox(t){this.checkPlanList=t},handleCreatePlan(){this.$jDynamic.show({component:"InterventionAddMdl",data:{modalType:1,addType:this.$route.params.type,modalTitle:"新增",confirmfunc:async t=>{const e=this.$store.state.intervention.tplList;e.push(t),this.$store.dispatch("intervention/setTplList",e)}},render:t=>t(v.a)})},handleEditOnePlan(t){this.$jDynamic.show({component:"InterventionAddMdl",data:{modalType:2,addType:this.$route.params.type,modalTitle:"编辑",planId:t.planId,id:t.id,propsData:t,confirmfunc:async t=>{const e=[...this.$store.state.intervention.tplList],a=[],s=[];e.forEach(e=>{const i=Object.assign({},e);i.id!==t.id||i.planId||s.push(t.id),(i.planId===t.planId||i.id===t.id&&void 0!==t.id)&&(i.planId=t.planId,i.planTime=t.planTime,i.planWay=t.planWay,i.planDoctor=t.planDoctor,i.planDoctorName=t.planDoctorName,i.planTitle=t.planTitle,i.planContent=t.planContent,i.templateQuestionId=t.templateQuestionId,i.templateQuestionName=t.templateQuestionName,delete i.id),a.push(i)}),this.$store.dispatch("intervention/setTplList",a),"1"===this.$route.params.type&&this.$refs.InterventionTabMdl.resetMultipleSelectionAll(s)}},render:t=>t(v.a)})},handleEditPlan(){1===this.checkPlanList.length?this.$jDynamic.show({component:"InterventionAddMdl",data:{modalType:2,addType:this.$route.params.type,modalTitle:"编辑",planId:this.checkPlanList[0].planId,id:this.checkPlanList[0].id,propsData:this.checkPlanList[0],confirmfunc:async t=>{const e=[...this.$store.state.intervention.tplList],a=[],s=[];e.forEach(e=>{const i=Object.assign({},e);i.id!==t.id||i.planId||s.push(t.id),(i.planId===t.planId||i.id===t.id&&void 0!==t.id)&&(i.planId=t.planId,i.planTime=t.planTime,i.planWay=t.planWay,i.planDoctor=t.planDoctor,i.planDoctorName=t.planDoctorName,i.planTitle=t.planTitle,i.planContent=t.planContent,i.templateQuestionId=t.templateQuestionId,i.templateQuestionName=t.templateQuestionName,delete i.id),a.push(i)}),this.$store.dispatch("intervention/setTplList",a),"1"===this.$route.params.type&&this.$refs.InterventionTabMdl.resetMultipleSelectionAll(s)}},render:t=>t(v.a)}):this.$message({message:"请选择一条记录编辑",type:"warning"})},handleDeletePlan(){0!==this.checkPlanList.length?this.$confirm(`<div class="delete-text-content"><img class="delete-icon" src="${w.a}"/><span>该操作无法撤销，是否确认删除！</span></div>`,"删除提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"message-box-customize",showClose:!0}).then(async()=>{const t=[],e=[...this.$store.state.intervention.tplList];this.checkPlanList.forEach(a=>{const s=e.findIndex(t=>t.id?t.id===a.id:t.planId===a.planId);e.splice(s,1),a.id&&t.push(a.id)}),"1"===this.$route.params.type&&this.$refs.InterventionTabMdl.resetMultipleSelectionAll(t),this.$store.dispatch("intervention/setTplList",e)}):this.$message({message:"请选择要删除的记录",type:"warning"})},handleTogetherPlan(){this.checkPlanList.length<2?this.$message({message:"请选择至少两条记录进行合并",type:"warning"}):this.$jDynamic.show({component:"InterventionAddMdl",data:{modalType:3,addType:this.$route.params.type,modalTitle:"合并计划",propsData:this.checkPlanList,confirmfunc:async t=>{const e=[],a=[...this.$store.state.intervention.tplList];a.push(t),this.checkPlanList.forEach(t=>{const s=a.findIndex(e=>e.id?e.id===t.id:e.planId===t.planId);t.id&&e.push(t.id),a.splice(s,1)}),"1"===this.$route.params.type&&this.$refs.InterventionTabMdl.resetMultipleSelectionAll(e),this.$store.dispatch("intervention/setTplList",a)}},render:t=>t(v.a)})},cancel(){this.$store.dispatch("intervention/setTplList",[]),this.$router.push({path:"/health_plan/create_plan"})},async save(){if(0===this.$store.state.intervention.tplList.length)return this.$message.warning("请新增至少一条计划");const t=this.$store.state.intervention.checkUserList.map(t=>t.clientId),e=this.$store.state.intervention.tplList;e.forEach(t=>{const e=t;e.ignore=!1,e.planUserId=t.planDoctor,e.planDate=t.planTime+" 00:00:00",delete e.id});const a={organId:"",clientIds:t,intervenePlans:e.filter(t=>!t.ignore),executeState:"2"};await this.$api.userFollowInterface.saveIntervenePlan(a),1===this.routeType&&Object.assign(this.$data,this.$options.data()),this.$message.success("操作成功"),this.cancel()}}},I=(a("kgbn"),Object(l.a)(S,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create-edit"},[1===t.viewIndex?a("el-row",["1"===t.$route.params.type?a("el-col",{staticStyle:{"margin-top":"-35px"},attrs:{span:14}},[a("el-tabs",{staticClass:"two-tab",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"干预模板",name:"first"}},[a("intervention-tab-mdl",{ref:"InterventionTabMdl"})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"客户的主要健康状况",name:"second"}},[a("intervention-tab-userdetail-mdl",{on:{read:t.viewiInterventionDetail}})],1)],1)],1):t._e(),t._v(" "),"2"===t.$route.params.type?a("el-col",{attrs:{span:11}},[a("intervention-somecreate-mdl")],1):t._e(),t._v(" "),a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:"1"===t.$route.params.type?10:13}},[a("div",{staticClass:"tableTopDoDiv",staticStyle:{display:"block"}},[a("div",{staticClass:"divRightTitleDiv"},[a("div",{staticClass:"divRightTitle",staticStyle:{"margin-top":"14px"}},[t._v("\n            "+t._s("2"===t.$route.params.type?"批量创建":"计划列表")),a("div",{staticClass:"titleBiao"})])]),t._v(" "),a("div",{staticClass:"table-operate-buttons"},[a("operate-button",{attrs:{type:"add"},on:{click:t.handleCreatePlan}}),t._v(" "),a("operate-button",{attrs:{type:"delete"},on:{click:t.handleDeletePlan}}),t._v(" "),a("operate-button",{attrs:{type:"together"},on:{click:t.handleTogetherPlan}})],1)]),t._v(" "),a("el-form",{staticClass:"form-inline",attrs:{inline:!1,"label-position":t.labelPosition,model:t.form}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.filterTableList,align:"center","row-class-name":t.rowSameTime},on:{"selection-change":t.chooseCheckBox}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),a("el-table-column",{attrs:{prop:"planTime",label:"随访日期","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.planTime))])]}}],null,!1,2195967168)}),t._v(" "),a("el-table-column",{attrs:{prop:"planWay",label:"随访形式","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?t._e():a("span",[t._v(t._s(t.form.planWayList.find((function(t){return t.id===e.row.planWay}))?t.form.planWayList.find((function(t){return t.id===e.row.planWay})).name:""))]),t._v(" "),e.row.edit?a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择随访方式"},model:{value:e.row.planWay,callback:function(a){t.$set(e.row,"planWay",a)},expression:"scope.row.planWay"}},t._l(t.form.planWayList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e()]}}],null,!1,2478552626)}),t._v(" "),a("el-table-column",{attrs:{prop:"planDoctorName",label:"干预人","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.planDoctorName))])]}}],null,!1,136938035)}),t._v(" "),a("el-table-column",{attrs:{prop:"planTitle",label:"随访标题","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.planTitle))])]}}],null,!1,1265186805)}),t._v(" "),a("el-table-column",{attrs:{prop:"planContent",label:"随访提示","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.planContent))])]}}],null,!1,3765332828)}),t._v(" "),a("el-table-column",{attrs:{prop:"action",label:"操作",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleEditOnePlan(e.row)}}},[t._v("编辑\n              ")])]}}],null,!1,1153283433)})],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{staticClass:"cancelBtn",attrs:{size:"small"},on:{click:t.cancel}},[t._v("返回")]),t._v(" "),a("el-button",{staticClass:"sureBtn",attrs:{type:"primary",size:"small"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)],1):2===t.viewIndex?[a("intervention-detail",{attrs:{propsData:t.InterventionDetailRow},on:{cancel:function(e){t.viewIndex=1}}})]:t._e()],2)}),[],!1,null,"3de6db4a",null));e.default=I.exports},hAs4:function(t,e,a){},jd71:function(t,e,a){},kD45:function(t,e,a){},kgbn:function(t,e,a){"use strict";a("Bm3U")},yH3B:function(t,e,a){"use strict";a("9uph")}}]);