(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{FvxX:function(t,e,a){},U4iH:function(t,e,a){"use strict";a.r(e);var i=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"divTitle"},[e("span",[e("img",{attrs:{src:a("OygJ"),alt:""}})]),this._v("\n            单项检查\n          ")])}],s=a("vHrX"),n=a("sjzN"),l=a("IZzX"),r=a("M07H"),o=a("pvXR"),c=a("aVcm"),d=a("6vIJ"),p=a.n(d),h=a("kaQf"),u={name:"inspection_index",components:{MedicalHistoryForm:s.default,DetailDialog:n.a,QueryPage:l.a,Search:r.a,QueryFilter:o.a,OperateButton:c.a},data:()=>({isTrue:!1,total:0,tableData:[],gridList:[],formData:{keywords:"",startTime:"",endTime:"",clientGrid:"",gender:"",pageNo:1,pageSize:15},typeMap:{1:"门诊",2:"住院"},statusMap:{1:"未指定",2:"治疗中",3:"转诊",4:"转为慢病",5:"痊愈",6:"其他"},viewIndex:1,currentId:"",multipleSelection:[],clientTypeList:[],expands:[],getRowKeys:t=>t.id,expandData:{id:"",pageNo:1,pageSize:15,total:0,list:[]},loading:!1}),beforeRouteEnter(t,e,a){a(t=>{t.getClientTypeList(),t.queryList(),t.getGridList()})},methods:{upMore(){this.isTrue=!this.isTrue,this.$forceUpdate()},handleExpandPageChange(t){this.expandData.pageNo=t,this.getOtherPageList()},handleExpandChange(t,e){this.expands=e},expandsHandle(t){if(this.loading)return!1;this.expands.forEach(e=>{e.id!==t.id&&this.$refs.table.toggleRowExpansion(e)}),this.expands.includes(t)?this.$refs.table.toggleRowExpansion(t):(this.expandData.id=t.clientId,this.expandData.pageNo=1,this.getOtherPageList().then(()=>{this.$refs.table.toggleRowExpansion(t)}))},getOtherPageList(){return this.expandData.list=[],this.loading=!0,this.$api.medicalHistoryInterface.otherMedicalHistoryPageList(this.expandData.id,{pageNo:this.expandData.pageNo,pageSize:this.expandData.pageSize}).then(({data:t})=>{this.expandData.list=t.data.list,this.expandData.total=t.data.total,this.loading=!1,this.tableData=[...this.tableData],this.$forceUpdate()}).catch(()=>{this.loading=!1})},getClientTypeList(){this.$api.medicalHistoryInterface.clientTypeList({pageNo:1,pageSize:h.a}).then(t=>{this.clientTypeList=t.data.data.list})},handleSelectionChange(t){this.multipleSelection=t},async getGridList(){const t=await this.$api.userManagerInterface.getGridList({pageNo:1,pageSize:1e4}),{data:e}=t.data;this.gridList=e.data},queryList(){console.log({...this.formData},"123123"),this.$api.medicalHistoryInterface.singleinspectionPageList({...this.formData}).then(t=>{const{data:e}=t;if(e){const t=e.data||{};this.tableData=t.data||[],this.total=t.total||0}})},reset(){this.formData.keyWord="",this.formData.workUnitName="",this.formData.clientGrid="",this.formData.department="",this.formData.hospital="",this.formData.startTime="",this.formData.endTime="",this.formData.pageNo=1,this.queryList()},search(){this.formData.pageNo=1,this.queryList()},resetAll(){this.formData.keywords="",this.formData.startTime="",this.formData.endTime="",this.formData.clientGrid="",this.formData.gender="",this.formData.pageNo=1,this.formData.pageSize=15,this.queryList()},handleEnter(){this.$refs.search.blur()},handleCurrentChange(t){this.formData.pageNo=t,this.queryList()},handleSizeChange(t){this.formData.pageSize=t,this.queryList()},add(){this.viewIndex=2,this.currentId="",this.$router.push({path:"/inspection_index_add",query:{id:""}})},adds(t){this.viewIndex=2,this.currentId="",this.$router.push({path:"/inspection_index_add",query:{id:t.id}})},detail(t){this.currentId=t.id,this.$router.push({path:"/inspection_index_info",query:{id:t.id}})},handleEdit(){return 0===this.multipleSelection.length?(this.$message.error("请先选择数据"),!1):this.multipleSelection.length>1?(this.$message.error("请选择单条记录编辑"),!1):void this.edit(this.multipleSelection[0])},edit(t){console.log(t),this.viewIndex=3,this.currentId=t.id,this.$router.push({path:"/inspection_index_add",query:{id:t.id}})},handleDelete(){if(0===this.multipleSelection.length)return this.$message.error("请先选择数据"),!1;this.remove(this.multipleSelection.map(t=>t.id),!0)},remove(t,e=!1){console.log(t,e,"删除"),this.$confirm(`<div class="delete-text-content"><img class="delete-icon" src="${p.a}"/><span>该操作无法撤销，是否确认${e?"批量":""}删除！</span></div>`,"删除提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",cancelButtonText:"取消",customClass:"message-box-customize",showClose:!0}).then(()=>{let e;e=this.$api.medicalHistoryInterface.singleinspectionDelete(t),e.then(t=>{const{data:e}=t;e&&(this.$message.success("操作成功"),this.queryList())})})},handleAfterSubmit(){this.viewIndex=1,this.queryList()},checkRangeDate(){return!(this.formData.startTime&&this.formData.endTime&&new Date(this.formData.startTime)>new Date(this.formData.endTime))||(this.$message.error("开始时间不可大于结束时间"),!1)}}},m=(a("VQre"),a("KHd+")),g=Object(m.a)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"medical-history"},[[[i("div",{staticClass:"table-operate-buttonss",staticStyle:{"margin-top":"-8px"}},[i("div",{staticClass:"divTop"},[t._m(0),t._v(" "),i("div",{staticClass:"searchCondition"},[i("div",{staticClass:"searchLeft"},[i("div",{staticClass:"searchInputFormItem"},[i("el-input",{attrs:{placeholder:"姓名/手机号/企业单位"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),t._v(" "),i("span",{staticClass:"searchBtnImgSpan",on:{click:t.search}},[i("img",{staticClass:"searchBtnImg",attrs:{src:a("RQrH")}})])],1),t._v(" "),i("div",[i("span",[t._v("客户性别：")]),t._v(" "),i("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择"},model:{value:t.formData.gender,callback:function(e){t.$set(t.formData,"gender",e)},expression:"formData.gender"}},[i("el-option",{key:"1",attrs:{label:"男",value:"1"}}),t._v(" "),i("el-option",{key:"2",attrs:{label:"女",value:"2"}})],1)],1),t._v(" "),i("div",[i("span",[t._v("人员类别：")]),t._v(" "),i("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择"},model:{value:t.formData.clientGrid,callback:function(e){t.$set(t.formData,"clientGrid",e)},expression:"formData.clientGrid"}},t._l(t.gridList,(function(t,e){return i("el-option",{key:e,attrs:{label:t.gridName,value:t.id}})})),1)],1),t._v(" "),i("div",[i("span",[t._v("体检日期：")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"100px"},attrs:{"value-format":"yyyy-MM-dd hh:mm:ss",type:"date","max-date":t.formData.endTime,placeholder:"选择开始日期"},model:{value:t.formData.startTime,callback:function(e){t.$set(t.formData,"startTime",e)},expression:"formData.startTime"}}),t._v(" "),i("span",{staticClass:"timing"},[t._v("-")]),t._v(" "),i("el-date-picker",{staticStyle:{width:"100px"},attrs:{"value-format":"yyyy-MM-dd hh:mm:ss",type:"date","min-date":t.formData.startTime,placeholder:"选择结束日期"},model:{value:t.formData.endTime,callback:function(e){t.$set(t.formData,"endTime",e)},expression:"formData.endTime"}})],1)]),t._v(" "),i("div",{staticClass:"searchRight"},[i("div",{staticClass:"buttones"},[i("div",{staticClass:"searchFor",on:{click:t.search}},[i("img",{attrs:{src:a("nc5h"),alt:""}})]),t._v(" "),i("div",{staticClass:"resetAll",on:{click:t.resetAll}},[t._v("重置")])])])])]),t._v(" "),i("div",{staticClass:"topbottomborder"}),t._v(" "),i("div",{staticClass:"operates"},[t.getAccess("inspection_index_add")?i("operate-button",{attrs:{type:"add"},on:{click:t.add}}):t._e(),t._v(" "),t.getAccess("inspection_index_deleted")?i("operate-button",{attrs:{type:"delete"},on:{click:t.handleDelete}}):t._e()],1)]),t._v(" "),i("div",[i("el-table",{ref:"table",staticClass:"has-expand-table",attrs:{data:t.tableData,"row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange,"expand-change":t.handleExpandChange}},[i("el-table-column",{attrs:{type:"expand",width:"1","class-name":"hide-expand-column"}},[i("el-table",{staticClass:"expand-table",attrs:{data:t.expandData.list}},[i("el-table-column",{attrs:{label:"就医日期",prop:"inDate",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"医疗机构",prop:"hospital",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"就医科室",prop:"department",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"诊断",prop:"diagnosis","show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"当前状态",prop:"result",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.statusMap[e.row.result]))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"index",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getAccess("medical_history_view")?i("el-button",{attrs:{type:"text"},on:{click:function(a){return t.detail(e.row)}}},[t._v("查看")]):t._e()]}}])})],1),t._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("el-pagination",{staticStyle:{"margin-top":"15px"},attrs:{background:"",total:t.expandData.total,"page-size":t.expandData.pageSize,"current-page":t.expandData.pageNo,"hide-on-single-page":!0,"page-sizes":[15],layout:"prev, pager, next, jumper, total, sizes"},on:{"current-change":t.handleExpandPageChange}})],1)],1),t._v(" "),i("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"客户编号",prop:"clientNo",align:"center","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"姓名",align:"center",prop:"clientName","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"性别",prop:"gender",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(1===e.row.gender?"男":2===e.row.gender?"女":"")+"\n              ")]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"年龄",align:"center",prop:"age","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"检查单号",align:"center",prop:"inspectionNo","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"检查机构",align:"center",prop:"inspectionOrg","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"检查日期",align:"center",prop:"inspectionDate","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"检查项目",align:"center",prop:"itemNames","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"次数",align:"center",prop:"inspectionCount","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"id",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.getAccess("inspection_index_edit")?i("el-button",{staticStyle:{color:"#3154AC"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.adds(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),i("span",{staticStyle:{color:"#DDE0E6"}},[t._v("|")]),t._v(" "),t.getAccess("medical_history_view")?i("el-button",{staticStyle:{color:"#3154AC"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.detail(e.row)}}},[t._v("查看")]):t._e()]}}])})],1),t._v(" "),i("el-pagination",{staticStyle:{"margin-top":"15px"},attrs:{background:"",total:t.total,"page-size":15,"current-page":t.formData.pageNo,"page-sizes":[15],layout:"prev, pager, next, jumper, total, sizes"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)]],t._v(" "),4===t.viewIndex?i("detail-dialog",{attrs:{id:t.currentId},on:{close:function(e){t.viewIndex=1}}}):t._e()],2)}),i,!1,null,"7b1e4da1",null);e.default=g.exports},VQre:function(t,e,a){"use strict";a("FvxX")}}]);